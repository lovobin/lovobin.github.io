<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Node基础 | 源于此</title><meta name="keywords" content="Javascript,Node"><meta name="author" content="源于此"><meta name="copyright" content="源于此"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="Node基础命令行基础 常用指令  Win+r调出DOS窗口  cd目录名 进入指定目录  md目录名 创建一个文件夹  rd 目录名 删除一个文件夹    目录  .表示当前目录 ..表示上一级目录   环境变量   进程和线程 进程: 进程负责为程序的运行提供必备的环境 线程: 线程计算机中的最小的计算单位，线程负责执行进程中的程序 Node的服务器是单线程的: Node 处理请求时是单线程,"><meta property="og:type" content="article"><meta property="og:title" content="Node基础"><meta property="og:url" content="https://lovobin.github.io/2021/02/04/Node%E5%9F%BA%E7%A1%80/index.html"><meta property="og:site_name" content="源于此"><meta property="og:description" content="Node基础命令行基础 常用指令  Win+r调出DOS窗口  cd目录名 进入指定目录  md目录名 创建一个文件夹  rd 目录名 删除一个文件夹    目录  .表示当前目录 ..表示上一级目录   环境变量   进程和线程 进程: 进程负责为程序的运行提供必备的环境 线程: 线程计算机中的最小的计算单位，线程负责执行进程中的程序 Node的服务器是单线程的: Node 处理请求时是单线程,"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="https://cdn.jsdelivr.net/gh/lovobin/hiddenContent@v1.0.5/bg/13.jpg"><meta property="article:published_time" content="2021-02-04T09:21:41.000Z"><meta property="article:modified_time" content="2021-03-17T05:10:00.430Z"><meta property="article:author" content="源于此"><meta property="article:tag" content="Javascript"><meta property="article:tag" content="Node"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://cdn.jsdelivr.net/gh/lovobin/hiddenContent@v1.0.5/bg/13.jpg"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://lovobin.github.io/2021/02/04/Node%E5%9F%BA%E7%A1%80/"><link rel="preconnect" href="//cdn.jsdelivr.net"><link rel="preconnect" href="//busuanzi.ibruce.info"><meta name="yandex-verification" content="{&quot;theme_color&quot;:{&quot;enable&quot;:true,&quot;main&quot;:&quot;#49B1F5&quot;,&quot;paginator&quot;:&quot;#00c4b6&quot;,&quot;button_hover&quot;:&quot;#FF7242&quot;,&quot;text_selection&quot;:&quot;#00c4b6&quot;,&quot;link_color&quot;:&quot;#99a9bf&quot;,&quot;meta_color&quot;:&quot;#858585&quot;,&quot;hr_color&quot;:&quot;#A4D8FA&quot;,&quot;code_foreground&quot;:&quot;#F47466&quot;,&quot;code_background&quot;:&quot;rgba(27, 31, 35, .05)&quot;,&quot;toc_color&quot;:&quot;#00c4b6&quot;,&quot;blockquote_padding_color&quot;:&quot;#49b1f5&quot;,&quot;blockquote_background_color&quot;:&quot;#49b1f5&quot;}}"><link rel="manifest" href="/image/pwa/manifest.json"><link rel="apple-touch-icon" sizes="180x180" href="/image/pwa/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/image/pwa/32.png"><link rel="icon" type="image/png" sizes="16x16" href="/image/pwa/16.png"><link rel="mask-icon" href="/image/pwa/safari-pinned-tab.svg" color="#5bbad5"><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload='this.media="all"'><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"search.xml","languages":{"hits_empty":"找不到您查询的内容：${query}"}},
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    jQuery: 'https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js',
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css'
    },
    fancybox: {
      js: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js',
      css: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: true,
  isanchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE={isPost:!0,isHome:!1,isHighlightShrink:!1,isToc:!0,postUpdate:"2021-03-17 05:10:00"}</script><noscript><style type="text/css">#nav{opacity:1}.justified-gallery img{opacity:1}#post-meta time,#recent-posts time{display:inline!important}</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    })(window)</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/l-lin/font-awesome-animation/dist/font-awesome-animation.min.css" media="defer" onload='this.media="all"'><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/lovobin/FileJsDeliver@v1.1.12/css/gitcalendar.css" media="defer" onload='this.media="all"'><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/lovobin/FileJsDeliver@v1.1.13/swiper/swiper.min.css" media="defer" onload='this.media="all"'><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/lovobin/FileJsDeliver@v1.1.13/swiper/swiperstyle.css" media="defer" onload='this.media="all"'><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/animate-css/animate.css@3.7.2/animate.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome/css/font-awesome.min.css" media="defer"><meta name="generator" content="Hexo 5.4.0"><link rel="alternate" href="/atom.xml" title="源于此" type="application/atom+xml"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="author-avatar"><img class="avatar-img" data-lazy-src="https://gitee.com/wang_hong_bin/pic-go-photos/raw/master/avatar.png" onerror='onerror=null,src="/img/friend_404.gif"' alt="avatar"></div><div class="site-data"><div class="data-item is-center"><div class="data-item-link"><a href="/archives/"><div class="headline">文章</div><div class="length-num">121</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/tags/"><div class="headline">标签</div><div class="length-num">64</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/categories/"><div class="headline">分类</div><div class="length-num">27</div></a></div></div></div><hr><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i> <span>首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i> <span>归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i> <span>标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i> <span>分类</span></a></div><div class="menus_item"><a class="site-page" href="/Timeline/"><i class="fa-fw fab fa-docker"></i> <span>日志</span></a></div><div class="menus_item"><a class="site-page" href="/shuoshuo/"><i class="fa-fw fab fa-d-and-d"></i> <span>说说</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i> <span>友情链接</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i> <span>关于</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image:url(https://cdn.jsdelivr.net/gh/lovobin/hiddenContent@v1.0.5/bg/13.jpg)"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">源于此</a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i> <span>搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i> <span>首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i> <span>归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i> <span>标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i> <span>分类</span></a></div><div class="menus_item"><a class="site-page" href="/Timeline/"><i class="fa-fw fab fa-docker"></i> <span>日志</span></a></div><div class="menus_item"><a class="site-page" href="/shuoshuo/"><i class="fa-fw fab fa-d-and-d"></i> <span>说说</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i> <span>友情链接</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i> <span>关于</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">Node基础</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2021-02-04T09:21:41.000Z" title="发表于 2021-02-04 09:21:41">2021-02-04</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2021-03-17T05:10:00.430Z" title="更新于 2021-03-17 05:10:00">2021-03-17</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/Node/">Node</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h3 id="Node基础"><a href="#Node基础" class="headerlink" title="Node基础"></a>Node基础</h3><h4 id="命令行基础"><a href="#命令行基础" class="headerlink" title="命令行基础"></a>命令行基础</h4><ul><li><p>常用指令</p><ol><li><p><code>Win+r</code>调出<code>DOS</code>窗口</p></li><li><p><code>cd</code>目录名 进入指定目录</p></li><li><p><code>md</code>目录名 创建一个文件夹</p></li><li><p><code>rd</code> 目录名 删除一个文件夹</p></li></ol></li><li><p>目录</p><ol><li><code>.</code>表示当前目录</li><li><code>..</code>表示上一级目录</li></ol></li><li><p>环境变量</p></li></ul><h4 id="进程和线程"><a href="#进程和线程" class="headerlink" title="进程和线程"></a>进程和线程</h4><blockquote><p>进程: 进程负责为程序的运行提供必备的环境</p><p>线程: 线程计算机中的最小的计算单位，线程负责执行进程中的程序</p><p>Node的服务器是单线程的: Node 处理请求时是单线程,但是在后台拥有一个I/O线程池</p></blockquote><h4 id="Node-简介"><a href="#Node-简介" class="headerlink" title="Node 简介"></a>Node 简介</h4><ul><li><p>简介</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1.</span> Node.js 是一个能够在服务器端运行 Javascript 的开放源代码、跨平台 Javascript 运行环境。</span><br><span class="line"><span class="number">2.</span> Node 采用Google开发的 V8 引擎运行 js 代码，使用事件驱动、非阻塞和异步I/O模型等技术来提高性能、可优化应用程序的传输量和规模。</span><br></pre></td></tr></table></figure></li></ul><h4 id="Node-安装使用"><a href="#Node-安装使用" class="headerlink" title="Node 安装使用"></a>Node 安装使用</h4><ul><li><p>安装 <a target="_blank" rel="noopener" href="https://nodejs.org/en/">点击前往 Node 官网</a></p></li><li><p>检测</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">node --version</span><br></pre></td></tr></table></figure><ul><li><p>成功显示版本号</p></li><li><p>安装失败错误代码<code>2502,2503</code></p><ol><li><p>安装权限不足</p><ul><li>以管理员身份运行<code>powershell: windows+x</code></li><li>输入运行安装包命令<code>msiexec/package [ D:\Program Files\nodejs\replace-your-node-path node-v10.13.0-x64.msi your-node-version</code></li></ul></li><li><p>安装验证失败</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">添加系统环境变量</span><br><span class="line"></span><br><span class="line">找到系统中的 node.exe 的路径添加系统环境变量后退出执行:</span><br><span class="line"></span><br><span class="line">windows+r: cmd  node -v</span><br><span class="line"></span><br></pre></td></tr></table></figure> <img src="https://cdn.jsdelivr.net/gh/lovobin/FileJsDeliver@v1.1.13/gif/3.gif" data-lazy-src="https://gitee.com/wang_hong_bin/repo-bin/raw/master/nodepath.png" width="600"></li></ol></li></ul></li><li><p>使用</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">node 文件名.js</span><br></pre></td></tr></table></figure> <img src="https://cdn.jsdelivr.net/gh/lovobin/FileJsDeliver@v1.1.13/gif/3.gif" data-lazy-src="https://gitee.com/wang_hong_bin/repo-bin/raw/master/helloNode.png" width="400"></li><li><p>模块化</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">- 在 Node 中 一个 js 文件就是一个模块</span><br><span class="line">- 在 Node 中,每一个 js 文件中的 js 代码都是独立运行在一个函数中</span><br><span class="line"></span><br><span class="line">模块分成两大类:</span><br><span class="line">    核心模块:</span><br><span class="line">        <span class="number">1.</span> 由 Node 引擎提供的模块</span><br><span class="line">        <span class="number">2.</span> 核心模块的标识就是模块的名称</span><br><span class="line">    文件模块:</span><br><span class="line">	<span class="number">1.</span> 由用户自己创建的模块</span><br><span class="line">        <span class="number">2.</span> 文件模块的标识就是文件的路径(绝对路径、相对路径)</span><br><span class="line">			</span><br><span class="line">			相对路径使用  . 或 .. 开头</span><br></pre></td></tr></table></figure></li><li><p>外部模块引入</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">在 node 模块中,通过 require() 函数来引入外部的模块</span><br><span class="line">    </span><br><span class="line">    require() 可以传递一个文件的路径作为参数, node 将会自动根据该路径来引入外部模块</span><br><span class="line"></span><br><span class="line">    使用 require() 引入模块以后,该函数会返回一个对象，这个对象代表是引入的模块</span><br><span class="line">    </span><br><span class="line">    exports 向外部暴露变量和方法</span><br><span class="line">	只需要将需要暴露给外部的变量或方法设置为 exports 的属性</span><br><span class="line">	</span><br></pre></td></tr></table></figure></li><li><p><code>exports</code>使用</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">A.js: <span class="built_in">exports</span>.x = <span class="string">&#x27;Hello World 模块的 x &#x27;</span></span><br><span class="line"></span><br><span class="line">B.js: </span><br><span class="line"></span><br><span class="line">	引入 A 模块: <span class="keyword">var</span> md = <span class="built_in">require</span>(<span class="string">&#x27;file-path/A&#x27;</span>);</span><br><span class="line">					<span class="built_in">console</span>.log(md.x) <span class="comment">// B模块输出: Hello World 模块的 x</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">exports</span> 是 <span class="built_in">module</span>.exports 的别名(地址引用关系),导出对象最终以 <span class="built_in">module</span>.exports 为准。</span><br><span class="line"></span><br></pre></td></tr></table></figure></li><li><p><code>global</code></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">在 node 中有一个全局对象 <span class="built_in">global</span> 它的作用和网页中 <span class="built_in">window</span> 类似</span><br><span class="line"></span><br><span class="line">在全局中创建的变量都会作为 <span class="built_in">global</span> 的属性保存</span><br><span class="line"></span><br><span class="line">在全局中创建的函数都会作为 <span class="built_in">global</span> 的方法保存</span><br><span class="line"></span><br><span class="line">当 node 执行模块中的代码时,它会首先在代码的最顶端,添加如下代码</span><br><span class="line"><span class="function"><span class="keyword">function</span>(<span class="params"><span class="built_in">exports</span>,<span class="built_in">require</span>,modelm__filename,__dirname&#123;</span></span></span><br><span class="line"><span class="function"><span class="params">          </span></span></span><br><span class="line"><span class="function"><span class="params">          在代码最底部,添加如下代码</span></span></span><br><span class="line"><span class="function"><span class="params">          &#125;</span></span></span><br></pre></td></tr></table></figure></li></ul><h4 id="包（package）"><a href="#包（package）" class="headerlink" title="包（package）"></a>包（package）</h4><ul><li><p><code>package</code></p><ol><li><code>CommonJS</code> 的包规范允许我i们将一组相关的模块泽合到一起，形成一组完整的工具</li><li> <code>CommonJS</code> 的包规范由包结构和包描述文件两个部分组成</li></ol></li><li><p>包结构: 用于组织包中的各种文件</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">包实际上就是一个压缩文件,解压后还原为目录。符合规范的目录,应该包含如下文件:</span><br><span class="line"></span><br><span class="line">    - package.json 描述文件</span><br><span class="line">    - bin 可执行二进制文件</span><br><span class="line">    - doc 文档</span><br><span class="line">    - test 单元测试</span><br><span class="line">     </span><br></pre></td></tr></table></figure></li><li><p>包描述文件: 描述包的相关信息，以供外部读取分析</p></li><li><p><code>npm(Node Package Manager)</code></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">npm search package-name <span class="comment">// 搜索</span></span><br><span class="line"></span><br><span class="line">npm install package-name <span class="comment">// 下载</span></span><br><span class="line"></span><br></pre></td></tr></table></figure></li><li><p>配置<code>cnpm</code></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 安装 cnpm</span></span><br><span class="line">npm install -g cnpm --registry=https:<span class="comment">//registry.npm.taobao.org || npm install --global cnpm</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 常用命令</span></span><br><span class="line">安装包</span><br><span class="line">cnpm i &lt;pkg&gt;  或者 cnpminstall &lt;pkg&gt;  或者  cnpm i &lt;pkg&gt;@&lt;version&gt;  或者  cnpminstall &lt;pkg&gt;@&lt;version&gt;</span><br><span class="line"></span><br><span class="line">卸载包</span><br><span class="line">cnpm uninstall &lt;name&gt; 或者 cnpm uninstall &lt;name&gt;@[&lt;version&gt;]</span><br><span class="line"></span><br><span class="line">查看当前项目下的包列表</span><br><span class="line">cnpm ls</span><br><span class="line"></span><br><span class="line">查看全局包列表</span><br><span class="line">cnpm ls －g</span><br><span class="line"></span><br><span class="line">清理缓存</span><br><span class="line">cnpm cache clean</span><br><span class="line">                                                </span><br></pre></td></tr></table></figure></li></ul><h3 id="Node"><a href="#Node" class="headerlink" title="Node"></a>Node</h3><h4 id="系统模块"><a href="#系统模块" class="headerlink" title="系统模块"></a>系统模块</h4><h5 id="读写文件"><a href="#读写文件" class="headerlink" title="读写文件"></a>读写文件</h5><ul><li><p><code>fs</code></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">fs 是 file-system 的简写 就是文件系统的意思</span><br><span class="line"></span><br><span class="line">在 node 中如果想要进行文件操作，就必须引入 fs 这个核心模块</span><br><span class="line"></span><br><span class="line">fs.readFile(<span class="string">&#x27;文件路径/文件名称&#x27;</span>,[<span class="string">&#x27;文件编码&#x27;</span>],callback)</span><br></pre></td></tr></table></figure></li><li><p>文件读取</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">第一个参数就是要读取的文件路径</span><br><span class="line">第二个参数就是回调函数</span><br><span class="line">      成功</span><br><span class="line">          data 数据</span><br><span class="line">          error <span class="literal">null</span></span><br><span class="line">      失败</span><br><span class="line">          data <span class="literal">null</span></span><br><span class="line">          error 错误对象</span><br></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 引入 fs 模块</span></span><br><span class="line"><span class="keyword">var</span> fs = <span class="built_in">require</span>(<span class="string">&#x27;fs&#x27;</span>);</span><br><span class="line"><span class="comment">// 文件读取</span></span><br><span class="line">fs.readFile(<span class="string">&quot;./b.txt&quot;</span>, <span class="function"><span class="keyword">function</span> (<span class="params">error, data</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (error) &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&quot;读取文件失败&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(data.toString());</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure></li><li><p>写文件</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">第一个参数: 文件路径</span><br><span class="line">第二个参数: 文件内容</span><br><span class="line">第三个参数: 回调函数</span><br><span class="line"></span><br><span class="line">error</span><br><span class="line">	成功: </span><br><span class="line">		文件写入成功</span><br><span class="line">        error --&gt; <span class="literal">null</span></span><br><span class="line">	失败: </span><br><span class="line">		文件写入失败</span><br><span class="line">        error 就是错误对象</span><br><span class="line">   </span><br><span class="line"> fs.writeFile(<span class="string">&#x27;文件路径/文件名称&#x27;</span>,<span class="string">&#x27;数据&#x27;</span>,callback);</span><br><span class="line"></span><br></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">  <span class="keyword">var</span> fs = <span class="built_in">require</span>(<span class="string">&#x27;fs&#x27;</span>);</span><br><span class="line">  fs.writeFile(<span class="string">&#x27;./file-name&#x27;</span>,<span class="string">&#x27;write-content&#x27;</span>,<span class="function"><span class="keyword">function</span>(<span class="params">error</span>)</span>&#123;</span><br><span class="line">      <span class="keyword">if</span>(error)&#123;</span><br><span class="line">          <span class="built_in">console</span>.log(<span class="string">&#x27;写入失败&#x27;</span>);</span><br><span class="line">      &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">          <span class="built_in">console</span>.log(<span class="string">&#x27;文件写入成功···&#x27;</span>);</span><br><span class="line">      &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure></li><li><p>系统模块<code>path</code>路径操作</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">path.join(<span class="string">&#x27;路径&#x27;</span>,<span class="string">&#x27;路径&#x27;</span>,····)</span><br></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 主要是由于系统不同使用的路径分隔符不同</span></span><br><span class="line"><span class="comment">// 拼接如下路径 public/img/avatar</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">&quot;path&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> filepath = path.join(<span class="string">&quot;public&quot;</span>, <span class="string">&quot;img&quot;</span>, <span class="string">&quot;avatar&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(filepath);</span><br><span class="line"></span><br></pre></td></tr></table></figure></li><li><p>相对路径、绝对路径</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1.</span> 大多数情况下使用绝对路径,因为相对路径有时候相对的是命令行工具的当前工作目录</span><br><span class="line"><span class="number">2.</span> 在读取文件或者设置文件路径时都会选择绝对路径</span><br><span class="line"><span class="number">3.</span> 使用 __dirname 获取当前文件所在的绝对路径</span><br></pre></td></tr></table></figure></li><li><p>第三方模块</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">别人写好的m具有特定功能,我们能直接使用的模块即第三方模块，由于第三方模块都是由多个文件组成并且被放置在一个文件夹中,所以又名包名。</span><br><span class="line"></span><br><span class="line">https:<span class="comment">//www.npmjs.com/</span></span><br></pre></td></tr></table></figure></li></ul><h4 id="第三方模块"><a href="#第三方模块" class="headerlink" title="第三方模块"></a>第三方模块</h4><ul><li><p>第三方模块<code>nodemon</code>,很有必要安装使用,修改内容将会实时刷新,无需重新启动</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 下载 </span></span><br><span class="line">npm install nodemon --global</span><br><span class="line"></span><br><span class="line"><span class="comment">#检测安装</span></span><br><span class="line">nodemon -v</span><br><span class="line"></span><br><span class="line"><span class="comment"># 使用</span></span><br><span class="line">nodemon node-fils-name.js</span><br><span class="line"></span><br></pre></td></tr></table></figure> <img src="https://cdn.jsdelivr.net/gh/lovobin/FileJsDeliver@v1.1.13/gif/3.gif" data-lazy-src="https://gitee.com/wang_hong_bin/repo-bin/raw/master/nodemon.png" width="600"></li><li><p>第三方模块<code>nrm</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">nrm(npm registry manager): npm 下载地址切换工具 npm 默认下载地址在国外,国内下载速度慢</span><br><span class="line"></span><br><span class="line"><span class="comment"># 安装 nrm</span></span><br><span class="line">npm install nrm -g</span><br><span class="line"><span class="comment"># 显示可用下载列表</span></span><br><span class="line">nrm list</span><br><span class="line"><span class="comment"># 使用可用 镜像</span></span><br><span class="line">nrm use taobao</span><br><span class="line"><span class="comment">#  * 代表当前在用镜像</span></span><br></pre></td></tr></table></figure> <img src="https://cdn.jsdelivr.net/gh/lovobin/FileJsDeliver@v1.1.13/gif/3.gif" data-lazy-src="https://gitee.com/wang_hong_bin/repo-bin/raw/master/nrm.png" alt="下载失败" width="600"><ul><li><p>解决方案(未尝试)</p> <img src="https://cdn.jsdelivr.net/gh/lovobin/FileJsDeliver@v1.1.13/gif/3.gif" data-lazy-src="https://gitee.com/wang_hong_bin/repo-bin/raw/master/nrmresult.png"></li></ul></li><li><p>第三方模块<code>gulp</code></p><ol><li><p><code>gulp</code>能做什么</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">项目上线 HTML CSS JS 文件压缩</span><br><span class="line">语法转换(es6,less)</span><br><span class="line">公共文件抽离</span><br></pre></td></tr></table></figure></li><li><p><code>gulp</code>使用步骤</p><ul><li><p>项目中下载<code>gulp</code>库文件,要使用项目中根目录下执行<code>npm install gulp</code></p></li><li><p>在项目根目录下新建<code>gulpfile.js</code>文件，只能是这个文件名</p></li><li><p>重构项目的文件夹结构 <code>src</code> 目录放置源代码文件 <code>dist</code>目录放置构建后文件</p></li><li><p>在 <code>gulpfile.js</code>文件中编写任务</p></li><li><p>在命令行工具中执行<code>gulp</code>任务</p></li></ul></li><li><p> <code>gulp</code>中提供的方法</p></li></ol><ul><li><p><code>gulp.src()</code>获取任务要处理的文件</p></li><li><p><code>gulp.desc()</code>输出文件</p></li><li><p><code>gulp.task()</code>建立gulp任务</p></li><li><p><code>gulp.watch()</code>监控文件的变化</p></li><li><p>使用<code>gulp</code></p> <img src="https://cdn.jsdelivr.net/gh/lovobin/FileJsDeliver@v1.1.13/gif/3.gif" data-lazy-src="https://gitee.com/wang_hong_bin/repo-bin/raw/master/gulp.png"><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot; npm install gulp &quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 引入 gulp</span></span><br><span class="line"><span class="keyword">const</span> gulp = <span class="built_in">require</span>(<span class="string">&quot;gulp&quot;</span>);</span><br><span class="line"><span class="comment">// 使用 gulp.task() 方法建立任务</span></span><br><span class="line"><span class="comment">// 参数: 1.任务的名称</span></span><br><span class="line"><span class="comment">// 参数: 2. 任务的回调 </span></span><br><span class="line">gulp.task(<span class="string">&quot;first&quot;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// 获取要处理的文件</span></span><br><span class="line">  gulp</span><br><span class="line">    .src(<span class="string">&quot;./src/css/index/style.css&quot;</span>) <span class="comment">// src: 目录自定义 自动会生成</span></span><br><span class="line">    <span class="comment">// 将处理后的文件输出到 dist 目录，dest输出</span></span><br><span class="line">    .pipe(gulp.dest(<span class="string">&quot;./dist/css/index&quot;</span>)); <span class="comment">// dist: 目录自定义 自动会生成</span></span><br><span class="line">&#125;);</span><br><span class="line"><span class="comment">// 全局安装命令工具 npm install gulp-cli -g</span></span><br></pre></td></tr></table></figure><ul><li><p>下载命令工具,全局安装(全局安装: 多个项目都会使用, 库文件则不同)</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 安装</span></span><br><span class="line">npm install gulp-cli -g</span><br><span class="line"><span class="comment"># 检测</span></span><br><span class="line">gulp -v</span><br><span class="line"><span class="comment"># 使用</span></span><br><span class="line">gulp task-name [Eg. first]</span><br></pre></td></tr></table></figure> <img src="https://cdn.jsdelivr.net/gh/lovobin/FileJsDeliver@v1.1.13/gif/3.gif" data-lazy-src="https://gitee.com/wang_hong_bin/repo-bin/raw/master/gulpfirst.png"></li></ul></li><li><p><code>gulp</code>插件</p><ol><li><code>gulp-htmlmin</code> html 文件压缩</li><li> <code>gulp-csso</code>压缩css</li><li><code>gulp-babel</code>JavaScript语法转换</li><li><code>gulp-less</code>语法转换</li><li><code>gulp-uglify</code>压缩混淆 JavaScript</li><li><code>gulp-file-include</code>公共文件包含</li><li><code>browsersync</code> 浏览器实时同步</li></ol></li><li><p>使用插件</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">下载插件文档: https://www.npmjs.com/package/gulp-htmlmin</span><br><span class="line"></span><br><span class="line"> npm install --save gulp-htmlmin</span><br><span class="line"> </span><br></pre></td></tr></table></figure><ul><li><p>新建压缩 html 任务(先了解,等待后续补充)</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 引入 gulp</span></span><br><span class="line"><span class="keyword">const</span> gulp = <span class="built_in">require</span>(<span class="string">&quot;gulp&quot;</span>);</span><br><span class="line"><span class="comment">// 引用插件</span></span><br><span class="line"><span class="keyword">const</span> htmlmin = <span class="built_in">require</span>(<span class="string">&quot;gulp-htmlmin&quot;</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// html 任务 压缩 html</span></span><br><span class="line"><span class="comment">// 建立任务</span></span><br><span class="line">gulp.task(<span class="string">&quot;htmlmin&quot;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    gulp</span><br><span class="line">      <span class="comment">// 获取处理任务路径</span></span><br><span class="line">      .src(<span class="string">&quot;./src/*.html&quot;</span>)</span><br><span class="line">      <span class="comment">// 压缩 html 文件中的代码 collapseWhitespace 压缩空格? true 是 pipe( 任务事件 )</span></span><br><span class="line">      .pipe(htmlmin(&#123; <span class="attr">collapseWhitespace</span>: <span class="literal">true</span> &#125;))</span><br><span class="line">      <span class="comment">// 输出</span></span><br><span class="line">      .pipe(gulp.desc(<span class="string">&quot;dist&quot;</span>))</span><br><span class="line">  );</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></li><li><p>原 <code>html</code> 文件格式</p> <img src="https://cdn.jsdelivr.net/gh/lovobin/FileJsDeliver@v1.1.13/gif/3.gif" data-lazy-src="https://gitee.com/wang_hong_bin/repo-bin/raw/master/yuanhtml.png" width="600"></li><li><p>压缩后</p> <img src="https://cdn.jsdelivr.net/gh/lovobin/FileJsDeliver@v1.1.13/gif/3.gif" data-lazy-src="https://gitee.com/wang_hong_bin/repo-bin/raw/master/htmlmin.png"></li><li><p><code>构建</code>任务</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 构建任务  所有任务 通过 gulp default 全部执行</span></span><br><span class="line">gulp.task(<span class="string">&#x27;default&#x27;</span>,[<span class="string">&#x27;htmlmin&#x27;</span>,<span class="string">&#x27;first&#x27;</span>]);</span><br><span class="line"></span><br></pre></td></tr></table></figure></li></ul></li></ul></li></ul><h4 id="package-json"><a href="#package-json" class="headerlink" title="package.json"></a>package.json</h4><blockquote><p><code>node_modules</code> 无需传输，使用<code>npm install</code> 会自动前往 <code>package.json</code> 寻找依赖下载</p><p>项目描述文件,记录当前项目的项目信息,例如: 项目名称 版本 作者 <code>github</code> 地址 当前项目依赖了那些第三方模块 使用 <code>npm init -y</code> 生成</p></blockquote><ul><li><p><code>npm init -y</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="string">&quot;name&quot;</span>: <span class="string">&quot;node-day03&quot;</span>, </span><br><span class="line">  <span class="string">&quot;version&quot;</span>: <span class="string">&quot;1.0.0&quot;</span>,</span><br><span class="line">  <span class="string">&quot;description&quot;</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">  <span class="string">&quot;main&quot;</span>: <span class="string">&quot;gulp-demo.js&quot;</span>,</span><br><span class="line">  <span class="string">&quot;dependencies&quot;</span>: &#123; <span class="comment"># 项目依赖</span></span><br><span class="line">    <span class="string">&quot;gulp&quot;</span>: <span class="string">&quot;^4.0.2&quot;</span>,</span><br><span class="line">    <span class="string">&quot;gulp-file-include&quot;</span>: <span class="string">&quot;^2.3.0&quot;</span>,</span><br><span class="line">    <span class="string">&quot;gulp-htmlmin&quot;</span>: <span class="string">&quot;^5.0.1&quot;</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="string">&quot;devDependencies&quot;</span>: &#123;&#125;, <span class="comment"># 开发依赖 --save </span></span><br><span class="line">  <span class="string">&quot;scripts&quot;</span>: &#123;</span><br><span class="line">    <span class="string">&quot;test&quot;</span>: <span class="string">&quot;echo \&quot;Error: no test specified\&quot; &amp;&amp; exit 1&quot;</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="string">&quot;keywords&quot;</span>: [],</span><br><span class="line">  <span class="string">&quot;author&quot;</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">  <span class="string">&quot;license&quot;</span>: <span class="string">&quot;ISC&quot;</span> <span class="comment"># 开放源代码协议</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure></li><li><p>开发依赖</p><ol><li>在项目的开发阶段需要依赖，线上运营阶段不需要依赖第三方包，称为开发依赖</li><li> 使用 <code>npm install</code> 包名 <code>--save-dev</code> 命令将包名添加到<code>package.json</code>文件的 <code>devDependencies</code>字段中</li></ol></li><li><p><code>package-lock.json</code>文件的作用</p><ol><li>锁定包的版本,确保再次下载时不会因为包版本不同产生问题</li><li> 加快下载速度, 因为该文件中已经记录了项目所依赖第三方包的树状结构和包的下载地址，重新安装时只需下载即可,不需做额外工作</li></ol></li><li><p>命令别名</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">package.json: </span><br><span class="line">    <span class="string">&quot;scripts&quot;</span>: &#123;</span><br><span class="line">        <span class="string">&quot;test&quot;</span>: <span class="string">&quot;echo \&quot;Error: no test specified\&quot; &amp;&amp; exit 1&quot;</span>,</span><br><span class="line">        <span class="string">&quot;build&quot;</span>: <span class="string">&quot;nodemon app.js&quot;</span></span><br><span class="line">      &#125;</span><br><span class="line">       </span><br><span class="line"></span><br><span class="line"><span class="string">&quot;build&quot;</span>: <span class="string">&quot;命令&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="string">&quot;build&quot;</span>: <span class="string">&quot;nodemon app.js&quot;</span></span><br><span class="line"></span><br><span class="line"># 执行</span><br><span class="line">npm run 别名 Eg. npm run build</span><br><span class="line"></span><br></pre></td></tr></table></figure></li></ul><h4 id="服务器端基础概念"><a href="#服务器端基础概念" class="headerlink" title="服务器端基础概念"></a>服务器端基础概念</h4><ul><li><p>网站服务器</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">能够提供网站访问服务的机器就是网站服务器,它能够接受客户端的请求,能够对请求做出响应。</span><br></pre></td></tr></table></figure></li><li><p>URL</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">统一资源定位符,又叫 URL(uniform ResourceLocator) 是专门标识 Internet 网上资源位置而设的一种编址方式</span><br></pre></td></tr></table></figure></li><li><p>URL 的组成</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">输出协议://服务器 ip或域名:端口/资源所在位置标识</span><br><span class="line"></span><br><span class="line">https://lovobin.github.io:80/2021/02/Node%E5%9F%BA%E7%A1%80/</span><br><span class="line"></span><br><span class="line">http: 超文本传输协议, 提供了一种发布和接受 HTML 页面的方法</span><br><span class="line"></span><br></pre></td></tr></table></figure></li></ul><h4 id="简单的-http-服务"><a href="#简单的-http-服务" class="headerlink" title="简单的 http 服务"></a>简单的 http 服务</h4><ul><li><p>搭建简单的服务器</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 加载 http 核心模块</span></span><br><span class="line"><span class="keyword">var</span> http = <span class="built_in">require</span>(<span class="string">&quot;http&quot;</span>);</span><br><span class="line"><span class="comment">// 使用 http.createServer() 方法创建一个 Web 服务器 返回一个 server 实例</span></span><br><span class="line"><span class="keyword">var</span> server = http.createServer();</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">    当客户端请求过来,就会自动触发服务器的 request 请求事件,  然后执行第二个参数: 回调处理</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line">server.on(<span class="string">&quot;request&quot;</span>, <span class="function"><span class="keyword">function</span> (<span class="params">request, response</span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">&quot;收到客户端的请求了··&quot;</span> + request.url);</span><br><span class="line"></span><br><span class="line">  <span class="comment">/*</span></span><br><span class="line"><span class="comment">      response 对象有一个方法 write 可以用来给客户端发送响应数据</span></span><br><span class="line"><span class="comment">      write 可以使用多次,但是最后一定要使用 end 来结束响应 否则客户端会一直等待</span></span><br><span class="line"><span class="comment">      */</span></span><br><span class="line">  response.write(<span class="string">&quot;响应···&quot;</span>);</span><br><span class="line">  <span class="comment">// 告诉客户端 我的话说完了 你可以直接呈递给用户</span></span><br><span class="line">  response.end();</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 绑定端口号</span></span><br><span class="line">server.listen(<span class="number">3031</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">&quot;服务器启动成功，可以通过 http://127.0.0.1:3000/ 进行访问了&quot;</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br></pre></td></tr></table></figure></li><li><p>请求路径获取响应</p><ul><li><p>普通文本响应</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 引入 http 模块</span></span><br><span class="line"><span class="keyword">var</span> http = <span class="built_in">require</span>(<span class="string">&quot;http&quot;</span>);</span><br><span class="line"><span class="comment">// 创建 server</span></span><br><span class="line"><span class="keyword">var</span> server = http.createServer();</span><br><span class="line"><span class="comment">// 发送</span></span><br><span class="line">server.on(<span class="string">&quot;request&quot;</span>, <span class="function"><span class="keyword">function</span> (<span class="params">request, response</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&quot;收到请求了: &quot;</span> + request.url);</span><br><span class="line">    <span class="comment">// 根据不同的请求的路径,响应不同的内容</span></span><br><span class="line">    <span class="keyword">var</span> url = request.url;</span><br><span class="line">    <span class="keyword">if</span> (url === <span class="string">&quot;/&quot;</span>) &#123;</span><br><span class="line">        response.end(<span class="string">&quot;index Page&quot;</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (url === <span class="string">&quot;/login&quot;</span>) &#123;</span><br><span class="line">        response.end(<span class="string">&quot;user login&quot;</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (url === <span class="string">&quot;/register&quot;</span>) &#123;</span><br><span class="line">        response.end(<span class="string">&quot;user register&quot;</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        response.end(<span class="string">&quot;response ·····&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br><span class="line"><span class="comment">// 绑定端口号</span></span><br><span class="line">server.listen(<span class="number">3101</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&quot;服务器启动成功···可以通过127.0.0.1:3031 来访问了&quot;</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br></pre></td></tr></table></figure></li><li><p>响应 <code>json</code>数据类型</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 引入 http 模块</span></span><br><span class="line"><span class="keyword">var</span> http = <span class="built_in">require</span>(<span class="string">&quot;http&quot;</span>);</span><br><span class="line"><span class="comment">// 创建 server</span></span><br><span class="line"><span class="keyword">var</span> server = http.createServer();</span><br><span class="line"><span class="comment">// 发送</span></span><br><span class="line">server.on(<span class="string">&quot;request&quot;</span>, <span class="function"><span class="keyword">function</span> (<span class="params">request, response</span>) </span>&#123;</span><br><span class="line">    <span class="comment">// 配置响应编码</span></span><br><span class="line">    response.setHeader(<span class="string">&quot;Content-Type&quot;</span>, <span class="string">&quot;[text/plain 根据类型变化可选];charset=utf-8&quot;</span>);</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&quot;收到请求了: &quot;</span> + request.url);</span><br><span class="line">    <span class="comment">// 根据不同的请求的路径,响应不同的内容</span></span><br><span class="line">    <span class="keyword">var</span> url = request.url;</span><br><span class="line">    <span class="comment">// 定义json 类型数据</span></span><br><span class="line">    <span class="keyword">var</span> products = [</span><br><span class="line">        &#123;</span><br><span class="line">            brand: <span class="string">&quot;xiaomi&quot;</span>,</span><br><span class="line">            price: <span class="number">6699</span>,</span><br><span class="line">            color: <span class="string">&quot;blue&quot;</span>,</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">            brand: <span class="string">&quot;iPhone&quot;</span>,</span><br><span class="line">            price: <span class="number">9988</span>,</span><br><span class="line">            color: <span class="string">&quot;purple&quot;</span>,</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">            brand: <span class="string">&quot;huawei&quot;</span>,</span><br><span class="line">            price: <span class="number">9988</span>,</span><br><span class="line">            color: <span class="string">&quot;blue&quot;</span>,</span><br><span class="line">        &#125;,</span><br><span class="line">    ];</span><br><span class="line">    <span class="comment">// 响应的内容只能是 二进制数据或者字符串</span></span><br><span class="line">    <span class="keyword">if</span> (url === <span class="string">&quot;/products&quot;</span>) &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="built_in">JSON</span>.stringify(products));</span><br><span class="line">        response.end(<span class="built_in">JSON</span>.stringify(products));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br><span class="line"><span class="comment">// 绑定端口号</span></span><br><span class="line">server.listen(<span class="number">3101</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&quot;服务器启动成功···可以通过127.0.0.1:3031 来访问了&quot;</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br></pre></td></tr></table></figure></li></ul></li><li><p>常见<code>Content-Type</code>类型</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">常见的媒体格式类型如下：</span><br><span class="line">    text/html  HTML格式</span><br><span class="line">    text/plain 纯文本格式</span><br><span class="line">    text/xml  XML格式</span><br><span class="line">    image/gif gif图片格式</span><br><span class="line">    image/jpeg jpg图片格式</span><br><span class="line">    image/png png图片格式</span><br></pre></td></tr></table></figure></li></ul><h4 id="HTTP-协议"><a href="#HTTP-协议" class="headerlink" title="HTTP 协议"></a>HTTP 协议</h4><ul><li><p>http 协议的概念</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">超文本传输协议(英文: HyperText Transfer Protocol 缩写: HTTP) 规定了如何从网站服务器传输超文本到本地浏览器,它基于客户端服务器加构工作,是客户端服务器加构工作,是客户端和服务器端请求和应答的标准。</span><br></pre></td></tr></table></figure></li><li><p>报文</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">在 HTTP 请求和响应的过程中传递的数据块就叫报文m包括要传送的数据和一些附加信息,并且要遵循规定好的格式。</span><br></pre></td></tr></table></figure></li><li><p>请求报文</p><ol><li><p>请求方式</p><ul><li><code>GET</code></li><li><code>POST</code></li></ul></li><li><p> 请求地址</p></li></ol><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">server.on(<span class="string">&#x27;request&#x27;</span>,<span class="function">(<span class="params">req,res</span>)=&gt;</span>&#123;</span><br><span class="line">    req.headers <span class="comment">// 获取请求报文</span></span><br><span class="line">    req.url <span class="comment">// 获取请求地址</span></span><br><span class="line">    req.method <span class="comment">// 获取请求方式</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure></li></ul><h4 id="HTTP-请求与响应处理"><a href="#HTTP-请求与响应处理" class="headerlink" title="HTTP 请求与响应处理"></a>HTTP 请求与响应处理</h4><ul><li><p>GET 参数请求处理</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// http请求与响应.js</span></span><br><span class="line"><span class="keyword">const</span> http = <span class="built_in">require</span>(<span class="string">&quot;http&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> server = http.createServer();</span><br><span class="line"><span class="comment">// 处理 url</span></span><br><span class="line"><span class="keyword">const</span> url = <span class="built_in">require</span>(<span class="string">&quot;url&quot;</span>);</span><br><span class="line"><span class="comment">// req: request res: response</span></span><br><span class="line">server.on(<span class="string">&quot;request&quot;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  res.writeHeader(<span class="number">200</span>, &#123;</span><br><span class="line">    <span class="string">&quot;content-type&quot;</span>: <span class="string">&quot;text/plain;charset=utf8&quot;</span>,</span><br><span class="line">    hello: <span class="string">&quot;world&quot;</span>,</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 请求参数处理 http://127.0.0.1:3031/?username=zhangsan&amp;age=18</span></span><br><span class="line">  <span class="built_in">console</span>.log(req.url); <span class="comment">// /?username=zhangsan&amp;age=18</span></span><br><span class="line">  <span class="comment">// 字符串截取可以获取参数</span></span><br><span class="line">  <span class="comment">// 内置模块</span></span><br><span class="line">  <span class="built_in">console</span>.log(url.parse(req.url));</span><br><span class="line">  <span class="comment">/*</span></span><br><span class="line"><span class="comment">    1. 要解析的 url 地址</span></span><br><span class="line"><span class="comment">    2. 将查询的参数解析成对象形式</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">    url.parse(req.url,true)</span></span><br><span class="line"><span class="comment">  */</span></span><br><span class="line">  <span class="keyword">let</span> params = url.parse(req.url, <span class="literal">true</span>).query;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">&quot;params: &quot;</span>, params);</span><br><span class="line"></span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">&quot;params-username:&quot;</span>, params.username, <span class="string">&quot;params-age:&quot;</span>, params.age); <span class="comment">// zhangsan 18</span></span><br><span class="line">  res.end(<span class="string">&quot;请求成功&quot;</span>);</span><br><span class="line">&#125;);</span><br><span class="line">server.listen(<span class="number">3031</span>, <span class="function">(<span class="params">error</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">&quot;可以通过 127.0.0.1:3031/ 来访问服务器了····&quot;</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// 路径判断问题</span></span><br><span class="line"><span class="keyword">let</span> &#123;query,pathname&#125;=url.parse(req.url,<span class="literal">true</span>);</span><br><span class="line"><span class="built_in">console</span>.log(query.username,query.age);</span><br><span class="line"><span class="keyword">if</span>(pathname==<span class="string">&#x27;/index&#x27;</span> || pathname==<span class="string">&#x27;/&#x27;</span>)&#123;</span><br><span class="line">    res.end(<span class="string">&#x27;index home&#x27;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure> <img src="https://cdn.jsdelivr.net/gh/lovobin/FileJsDeliver@v1.1.13/gif/3.gif" data-lazy-src="https://gitee.com/wang_hong_bin/repo-bin/raw/master/getParse.png" width="400"></li><li><p>POST 参数请求处理</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// post请求参数.js</span></span><br><span class="line"><span class="comment">// http请求与响应.js</span></span><br><span class="line"><span class="keyword">const</span> http = <span class="built_in">require</span>(<span class="string">&quot;http&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> server = http.createServer();</span><br><span class="line"><span class="comment">// 处理请求参数模块 post 请求转换为 对象数据</span></span><br><span class="line"><span class="keyword">const</span> queryString = <span class="built_in">require</span>(<span class="string">&quot;querystring&quot;</span>);</span><br><span class="line"><span class="comment">// req: request res: response</span></span><br><span class="line">server.on(<span class="string">&quot;request&quot;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// 编码处理</span></span><br><span class="line">  res.writeHeader(<span class="number">200</span>, &#123;</span><br><span class="line">    <span class="string">&quot;content-type&quot;</span>: <span class="string">&quot;text/plain;charset=utf8&quot;</span>,</span><br><span class="line">  &#125;);</span><br><span class="line">  <span class="comment">// post 参数是通过事件的方式接受的</span></span><br><span class="line">  <span class="comment">// data 当请求参数传递的时候触发 data 事件</span></span><br><span class="line">  <span class="comment">// end 当参数传递完成的时候触发 end 事件</span></span><br><span class="line">  <span class="comment">// username=aidou&amp;password=123</span></span><br><span class="line">  <span class="keyword">let</span> postParams = <span class="string">&quot;&quot;</span>;</span><br><span class="line">  req.on(<span class="string">&quot;data&quot;</span>, <span class="function">(<span class="params">params</span>) =&gt;</span> &#123;</span><br><span class="line">    postParams += params;</span><br><span class="line">  &#125;);</span><br><span class="line">  req.on(<span class="string">&quot;end&quot;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(postParams);</span><br><span class="line">    <span class="keyword">let</span> querystr = queryString.parse(postParams);</span><br><span class="line">    <span class="built_in">console</span>.log(querystr); <span class="comment">// &#123; username: &#x27;aidou&#x27;, password: &#x27;123&#x27; &#125;</span></span><br><span class="line">  &#125;);</span><br><span class="line">  res.end(<span class="string">&quot;ok&quot;</span>);</span><br><span class="line">&#125;);</span><br><span class="line">server.listen(<span class="number">3031</span>, <span class="function">(<span class="params">error</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">&quot;可以通过 127.0.0.1:3031/ 来访问服务器了····&quot;</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br></pre></td></tr></table></figure></li></ul><h4 id="路由"><a href="#路由" class="headerlink" title="路由"></a>路由</h4><blockquote><p>路由是指客户端请求地址与服务器端程序代码的对应关系</p></blockquote><ul><li><p>路由处理</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> http = <span class="built_in">require</span>(<span class="string">&quot;http&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> server = http.createServer();</span><br><span class="line"><span class="keyword">const</span> url = <span class="built_in">require</span>(<span class="string">&quot;url&quot;</span>);</span><br><span class="line">server.on(<span class="string">&quot;request&quot;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  res.writeHeader(<span class="number">200</span>, &#123;</span><br><span class="line">    <span class="string">&quot;content-type&quot;</span>: <span class="string">&quot;text/html;charset=utf8&quot;</span>,</span><br><span class="line">  &#125;);</span><br><span class="line">  <span class="comment">// 获取请求方式</span></span><br><span class="line">  <span class="keyword">const</span> method = req.method.toLowerCase();</span><br><span class="line">  <span class="built_in">console</span>.log(method); <span class="comment">// GET---  toLowerCase() ---&gt; get</span></span><br><span class="line">  <span class="comment">// 获取请求地址</span></span><br><span class="line">  <span class="keyword">const</span> pathname = url.parse(req.url).pathname;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">&quot;pathname: &quot;</span>, pathname); <span class="comment">// pathname:  /index</span></span><br><span class="line">  <span class="keyword">if</span> (method == <span class="string">&quot;get&quot;</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (pathname == <span class="string">&quot;/&quot;</span> || pathname == <span class="string">&quot;/index&quot;</span>) &#123;</span><br><span class="line">      res.end(<span class="string">&quot;&lt;h1&gt; return get index home page &lt;/h1&gt;&quot;</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      res.end(<span class="string">&quot;&lt;h1&gt;Not Found GET&lt;/h1&gt;&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> (method == <span class="string">&quot;post&quot;</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (pathname == <span class="string">&quot;/&quot;</span> || pathname == <span class="string">&quot;/index&quot;</span>) &#123;</span><br><span class="line">      res.end(<span class="string">&quot;&lt;h1&gt; return post index home page &lt;/h1&gt;&quot;</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      res.end(<span class="string">&quot;&lt;h1&gt;Not Found POST&lt;/h1&gt;&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">server.listen(<span class="number">3031</span>, <span class="function">(<span class="params">error</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">&quot;ok&quot;</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></li><li><p>静态资源访问</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">服务器端不需要处理,可以直接响应给客户端的资源就是静态资源，例如 css javascript image 文件等</span><br></pre></td></tr></table></figure><ul><li><p>获取访问路径</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># 获取 pathname  </span><br><span class="line">url.parse(req.url).pathname</span><br></pre></td></tr></table></figure></li><li><p>获取当前文件的绝对路径</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"># path 模块</span><br><span class="line"></span><br><span class="line">path.join(__dirname, <span class="string">&quot;public&quot;</span> + pathname)</span><br><span class="line"></span><br></pre></td></tr></table></figure></li></ul></li><li><p>静态资源读取</p> <img src="https://cdn.jsdelivr.net/gh/lovobin/FileJsDeliver@v1.1.13/gif/3.gif" data-lazy-src="https://gitee.com/wang_hong_bin/repo-bin/raw/master/pathnameDefault.png"><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"># app.js</span><br><span class="line">    <span class="keyword">const</span> http = <span class="built_in">require</span>(<span class="string">&quot;http&quot;</span>);</span><br><span class="line">    <span class="keyword">const</span> url = <span class="built_in">require</span>(<span class="string">&quot;url&quot;</span>);</span><br><span class="line">    <span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">&quot;path&quot;</span>);</span><br><span class="line">    <span class="keyword">const</span> fs = <span class="built_in">require</span>(<span class="string">&quot;fs&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> server = http.createServer();</span><br><span class="line"></span><br><span class="line">    server.on(<span class="string">&quot;request&quot;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">      res.writeHead(<span class="number">200</span>, &#123;</span><br><span class="line">        <span class="string">&quot;content-type&quot;</span>: <span class="string">&quot;text/html;charset=utf8&quot;</span>,</span><br><span class="line">      &#125;);</span><br><span class="line">      <span class="comment">// 响应文件路径</span></span><br><span class="line">      <span class="keyword">let</span> pathname = url.parse(req.url).pathname;  </span><br><span class="line">      </span><br><span class="line">        #   pathname = pathname == &quot;/&quot; ? &quot;/default.html&quot; : pathname; 更新显示判断</span><br><span class="line">        </span><br><span class="line">      <span class="comment">// 绝对路径获取 url</span></span><br><span class="line">      <span class="keyword">let</span> realPath = path.join(__dirname, <span class="string">&quot;public&quot;</span> + pathname);</span><br><span class="line">      fs.readFile(realPath, <span class="function">(<span class="params">error, data</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (error != <span class="literal">null</span>) &#123;</span><br><span class="line">          res.end(<span class="string">&quot;读取失败···&quot;</span>);</span><br><span class="line">          <span class="keyword">return</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">          res.end(data);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;);</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    server.listen(<span class="number">3031</span>, <span class="function">(<span class="params">error</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="built_in">console</span>.log(<span class="string">&quot;ok&quot;</span>);</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br></pre></td></tr></table></figure></li><li><p><code>mime</code>模块</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">npm install mime</span><br><span class="line">const mime = require(<span class="string">&#x27;mime&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="built_in">let</span> <span class="built_in">type</span> = mime.getType(realPath);</span><br><span class="line">res.writeHead(200,&#123;</span><br><span class="line">	<span class="string">&#x27;content-type&#x27;</span>: <span class="built_in">type</span></span><br><span class="line">&#125;);</span><br><span class="line"></span><br></pre></td></tr></table></figure></li></ul><h4 id="同步API和异步API"><a href="#同步API和异步API" class="headerlink" title="同步API和异步API"></a>同步<code>API</code>和异步<code>API</code></h4><ol><li><p>同步API</p><blockquote><p>只有当前 <code>API</code> 执行完成后,才能继续执行下一个 <code>API</code></p></blockquote></li><li><p> 异步 API</p></li></ol><blockquote><p>当前 API 的执行不会阻塞后续代码的执行</p></blockquote><ol start="3"><li><p>比较</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// 同步 sync</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">&quot;before···&quot;</span>);</span><br><span class="line"><span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line"> <span class="comment">// 异步 async </span></span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">&quot;last···&quot;</span>);</span><br><span class="line">&#125;, <span class="number">20</span>);</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">&quot;after···&quot;</span>);</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure> <img src="https://cdn.jsdelivr.net/gh/lovobin/FileJsDeliver@v1.1.13/gif/3.gif" data-lazy-src="https://gitee.com/wang_hong_bin/repo-bin/raw/master/async.png" width="400"></li><li><p> 同步 <code>API</code> 和异步<code>API</code>的区别</p></li></ol><blockquote><p>同步 API 可以从返回值中拿到 API 的执行结果,但是异步 API 是不可以的</p><p>同步 API 从上到下依次执行，前面代码会阻塞后面代码的执行。（会等待循环结束后才会执行后面的代码）</p><p>异步 API 不会等待 API 执行完成后再向下执行代码</p></blockquote><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">------------------------------------- <span class="number">1</span> ----------------------------------</span><br><span class="line"><span class="comment">// 同步函数返回值问题</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">sum</span>(<span class="params">n1, n2</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> n1 + n2;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> value = sum(<span class="number">2</span>, <span class="number">3</span>);</span><br><span class="line"><span class="built_in">console</span>.log(value); <span class="comment">// 5</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 异步函数返回值问题</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getMsg</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;异步执行&quot;</span>;</span><br><span class="line">  &#125;, <span class="number">20</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> msg = getMsg();</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">&quot;return msg result: &quot;</span>, msg); <span class="comment">// undefined</span></span><br><span class="line"></span><br><span class="line">---------------------------------- <span class="number">2</span>: 同步 -------------------------------------</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; <span class="number">10</span>; i++) &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(i); <span class="comment">// 同步会等待循环结束后才会执行后面的代码</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">&#x27;for 循环后面的代码&#x27;</span>);</span><br><span class="line"></span><br><span class="line">---------------------------------- <span class="number">3</span>: 异步 -------------------------------------</span><br><span class="line">    </span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">&quot;code start running···············&quot;</span>);</span><br><span class="line"><span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">&quot;0.2 start code············&quot;</span>);</span><br><span class="line">&#125;, <span class="number">20</span>);</span><br><span class="line"></span><br><span class="line"><span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">&quot;0 start code············&quot;</span>);</span><br><span class="line">&#125;, <span class="number">0</span>);</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">&quot;code running end·············&quot;</span>);</span><br><span class="line"></span><br><span class="line">    </span><br></pre></td></tr></table></figure> <img src="https://cdn.jsdelivr.net/gh/lovobin/FileJsDeliver@v1.1.13/gif/3.gif" data-lazy-src="https://gitee.com/wang_hong_bin/repo-bin/raw/master/until.png" width="500"><ol start="5"><li><p>回调函数</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">作用: 可以拿到异步函数的返回值</span><br><span class="line"></span><br><span class="line"><span class="comment">// <span class="doctag">TODO:</span> 异步函数通过回调函数获取返回值</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getData</span>(<span class="params">callback</span>) </span>&#123;</span><br><span class="line">  <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    callback(&#123;</span><br><span class="line">      msg: <span class="string">&quot;hello node js&quot;</span>,</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br><span class="line">getData(<span class="function"><span class="keyword">function</span> (<span class="params">data</span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(data);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br></pre></td></tr></table></figure></li></ol><h4 id="Promise"><a href="#Promise" class="headerlink" title="Promise"></a>Promise</h4><blockquote><p>promise 出现的目的是解决 Node.js 异步编程中回调地狱的问题。</p></blockquote><ul><li><p>promise的基本使用方法</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> fs = <span class="built_in">require</span>(<span class="string">&quot;fs&quot;</span>);</span><br><span class="line"><span class="keyword">let</span> promise = <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// 读取文件</span></span><br><span class="line">  fs.readFile(<span class="string">&quot;D.txt&quot;</span>, <span class="string">&quot;utf8&quot;</span>, <span class="function">(<span class="params">error, data</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (error) &#123;</span><br><span class="line">      reject(error);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      resolve(data.toString());</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">promise</span><br><span class="line">  .then(<span class="function">(<span class="params">result</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(result);</span><br><span class="line">  &#125;)</span><br><span class="line">  .catch(<span class="function">(<span class="params">error</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(error);</span><br><span class="line">  &#125;);</span><br></pre></td></tr></table></figure></li><li><p> 顺序读取文件</p></li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 难以维护 </span></span><br><span class="line"><span class="keyword">const</span> fs = <span class="built_in">require</span>(<span class="string">&quot;fs&quot;</span>);</span><br><span class="line">fs.readFile(<span class="string">&quot;./A.txt&quot;</span>, <span class="string">&quot;utf8&quot;</span>, <span class="function">(<span class="params">error, data</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(data.toString());</span><br><span class="line">  fs.readFile(<span class="string">&quot;./B.txt&quot;</span>, <span class="string">&quot;utf8&quot;</span>, <span class="function">(<span class="params">error, data</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(data.toString());</span><br><span class="line">    fs.readFile(<span class="string">&quot;./C.txt&quot;</span>, <span class="string">&quot;utf8&quot;</span>, <span class="function">(<span class="params">error, data</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="built_in">console</span>.log(data.toString());</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br></pre></td></tr></table></figure><ul><li><p>解决<code>Node.js</code>回调地狱问题</p><details><summary> Node回调地狱问题</summary><div class="content"><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// promise 的基础使用 解决Node.js 的回调地狱</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">p1</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> (promise1 = <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// 读取文件</span></span><br><span class="line">    fs.readFile(<span class="string">&quot;A.txt&quot;</span>, <span class="string">&quot;utf8&quot;</span>, <span class="function">(<span class="params">error, data</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">if</span> (error) &#123;</span><br><span class="line">        reject(error);</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        resolve(data.toString());</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">p2</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> (promise2 = <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// 读取文件</span></span><br><span class="line">    fs.readFile(<span class="string">&quot;B.txt&quot;</span>, <span class="string">&quot;utf8&quot;</span>, <span class="function">(<span class="params">error, data</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">if</span> (error) &#123;</span><br><span class="line">        reject(error);</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        resolve(data.toString());</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">p3</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> (promise3 = <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// 读取文件</span></span><br><span class="line">    fs.readFile(<span class="string">&quot;C.txt&quot;</span>, <span class="string">&quot;utf8&quot;</span>, <span class="function">(<span class="params">error, data</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">if</span> (error) &#123;</span><br><span class="line">        reject(error);</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        resolve(data.toString());</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">p1()</span><br><span class="line">  .then(<span class="function">(<span class="params">r1</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(r1);</span><br><span class="line">    <span class="keyword">return</span> p2();</span><br><span class="line">  &#125;)</span><br><span class="line">  .then(<span class="function">(<span class="params">r2</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(r2);</span><br><span class="line">    <span class="keyword">return</span> p3();</span><br><span class="line">  &#125;)</span><br><span class="line">  .then(<span class="function">(<span class="params">r3</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(r3);</span><br><span class="line">  &#125;);</span><br></pre></td></tr></table></figure></div></details></li></ul><h4 id="异步函数"><a href="#异步函数" class="headerlink" title="异步函数"></a>异步函数</h4><blockquote><p>异步函数就是异步编程语法的终极解决方案,它可以让我们将异步代码写成同步的形式让代码不再有回调函数嵌套，使代码变得清晰明了。</p></blockquote><ul><li><p><code>async</code> 关键字</p><ol><li><p>普通函数定义前加<code>async</code>关键字 普通函数就变成异步函数</p></li><li><p> 异步函数默认返回 <code>promise</code>对象</p></li><li><p> 在异步函数内部使用 <code>return</code> 关键字进行结果返回 结果会被包裹再 <code>promise</code>对象中 return 关键字代替了 <code>resolve()</code></p></li><li><p> 在异步函数内部使用 <code>throw</code> 关键字抛出程序异常</p></li><li><p> 调用异步函数再链式调用 <code>then</code> 方法获取异步函数执行结果</p></li><li><p> 调用异步函数再链式调用 <code>catch</code>方法获取异步函数执行的错误信息</p></li></ol><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 异步函数</span></span><br><span class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">function</span> <span class="title">fn</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">throw</span> <span class="string">&#x27;throw error infomation&#x27;</span>;</span><br><span class="line">  <span class="keyword">return</span> <span class="string">&quot;return result data&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">console</span>.log(fn()); <span class="comment">//默认输出: Promise &#123; undifined &#125;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// then方法 catch方法</span></span><br><span class="line">fn()</span><br><span class="line">  .then(<span class="function">(<span class="params">data</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(data); <span class="comment">// 成功: Promise &#123; &#x27;return result data&#x27; &#125;</span></span><br><span class="line">  &#125;)</span><br><span class="line">  .catch(<span class="function">(<span class="params">error</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(error); <span class="comment">//失败: Promise &#123; &lt;rejected&gt; &#x27;throw error infomation&#x27; &#125;</span></span><br><span class="line">  &#125;);</span><br><span class="line"></span><br></pre></td></tr></table></figure></li><li><p><code>await</code>关键字</p><ol><li><code>await</code>关键字<code>只能</code>出现在异步函数中</li><li> <code>await promise await</code>后面只能写<code>promise</code>对象 写其他类型的 <code>API</code> 是不可以的</li><li> <code>await</code>关键字是可以暂停异步函数向下执行 知道 <code>promise</code>返回结果</li></ol><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">function</span> <span class="title">fn1</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="string">&quot;fn1&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">function</span> <span class="title">fn2</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="string">&quot;fn2&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">function</span> <span class="title">fn3</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="string">&quot;fn3&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 顺序执行 异步函数</span></span><br><span class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">function</span> <span class="title">runFn</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> r1 = <span class="keyword">await</span> fn1();</span><br><span class="line">  <span class="keyword">let</span> r2 = <span class="keyword">await</span> fn2();</span><br><span class="line">  <span class="keyword">let</span> r3 = <span class="keyword">await</span> fn3();</span><br><span class="line">  <span class="built_in">console</span>.log(r1, r2, r3);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">runFn();</span><br><span class="line"></span><br></pre></td></tr></table></figure></li><li><p>使用异步函数顺序读取文件</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> fs = <span class="built_in">require</span>(<span class="string">&quot;fs&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> promisify = <span class="built_in">require</span>(<span class="string">&quot;util&quot;</span>).promisify;</span><br><span class="line"><span class="keyword">const</span> readFile = promisify(fs.readFile);</span><br><span class="line"></span><br><span class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">function</span> <span class="title">run</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> r1 = <span class="keyword">await</span> readFile(<span class="string">&quot;./A.txt&quot;</span>, <span class="string">&quot;utf8&quot;</span>);</span><br><span class="line">  <span class="keyword">let</span> r2 = <span class="keyword">await</span> readFile(<span class="string">&quot;./B.txt&quot;</span>, <span class="string">&quot;utf8&quot;</span>);</span><br><span class="line">  <span class="keyword">let</span> r3 = <span class="keyword">await</span> readFile(<span class="string">&quot;./C.txt&quot;</span>, <span class="string">&quot;utf8&quot;</span>);</span><br><span class="line">  <span class="built_in">console</span>.log(r1, r2, r3);</span><br><span class="line">&#125;</span><br><span class="line">run()</span><br><span class="line"></span><br></pre></td></tr></table></figure></li></ul><h4 id="数据库"><a href="#数据库" class="headerlink" title="数据库"></a>数据库</h4><ul><li><p>概念</p><table><thead><tr><th align="center">术语</th><th align="center">解释说明</th></tr></thead><tbody><tr><td align="center"><code>database</code></td><td align="center">数据库<code>mongogdb</code> 数据库软件中可以建立多个数据库</td></tr><tr><td align="center"><code>collection</code></td><td align="center">集合 一组数据的集合 可以理解为 JavaScript 中的数组</td></tr><tr><td align="center"><code>document</code></td><td align="center">文档 一条具体的数据 可以理解为 JavaScript 对象</td></tr><tr><td align="center"><code>field</code></td><td align="center">字段 文档中的属性名 可以理解为 JavaScript中的对象属性</td></tr></tbody></table></li><li><p>第三方包</p><ul><li><p><code>使用 Node.js</code>操作Mongodb数据库需要依赖<code>Node.js</code>第三方包<code>mongoose</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install mongoose</span><br></pre></td></tr></table></figure></li><li><p>启动<code>mongodb</code>服务</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">net start mongodb</span><br></pre></td></tr></table></figure></li><li><p>关闭<code>mongodb</code>服务</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">net stop mongodb</span><br></pre></td></tr></table></figure></li><li><p>启动遇到如下错误</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">‘环境变量’  bin/</span><br><span class="line"></span><br><span class="line">发生系统错误 5。</span><br><span class="line"></span><br><span class="line">拒绝访问。</span><br><span class="line"></span><br><span class="line">解决: 使用管理员权限启动 mongodb 服务</span><br><span class="line"></span><br><span class="line"><span class="built_in">chdir</span> 命令: 获取 windows 的路径 == <span class="built_in">pwd</span></span><br></pre></td></tr></table></figure> <img src="https://cdn.jsdelivr.net/gh/lovobin/FileJsDeliver@v1.1.13/gif/3.gif" data-lazy-src="https://gitee.com/wang_hong_bin/repo-bin/raw/master/adminMon.png" width="600" alt="普通管理员" title="普通管理员"> <img src="https://cdn.jsdelivr.net/gh/lovobin/FileJsDeliver@v1.1.13/gif/3.gif" data-lazy-src="https://gitee.com/wang_hong_bin/repo-bin/raw/master/netStartMon.png" width="600" alt="超级管理员" title="超级管理员"></li></ul></li><li><p><code>Nodes</code>连接数据库</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 引入 mongoose  模块</span></span><br><span class="line"><span class="keyword">const</span> mongoose = <span class="built_in">require</span>(<span class="string">&quot;mongoose&quot;</span>);</span><br><span class="line">mongoose</span><br><span class="line">  .connect(<span class="string">&quot;mongodb://localhost/student&quot;</span>, &#123;</span><br><span class="line">    useNewUrlParser: <span class="literal">true</span>,</span><br><span class="line">    useUnifiedTopology: <span class="literal">true</span> </span><br><span class="line">  &#125;)</span><br><span class="line">  .then(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&quot;数据库连接成功&quot;</span>);</span><br><span class="line">  &#125;)</span><br><span class="line">  .catch(<span class="function">(<span class="params">error</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(error, <span class="string">&quot;连接失败&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br></pre></td></tr></table></figure></li><li><p>创建集合</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">创建集合分为两个步骤:</span><br><span class="line">	<span class="number">1.</span> 对集合设定规则</span><br><span class="line">    <span class="number">2.</span> 创建集合</span><br><span class="line">    创建 mongoose.Schema 构造函数的实例即可创建集合</span><br></pre></td></tr></table></figure></li></ul><h4 id="模板引擎"><a href="#模板引擎" class="headerlink" title="模板引擎"></a>模板引擎</h4><ul><li><p>模板引擎</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">模板引擎是第三方模块</span><br><span class="line"></span><br><span class="line">让开发者以更加友好的方式拼接字符串,使项目代码更加清晰,更加易于维护。</span><br></pre></td></tr></table></figure></li><li><p>模板引擎下载</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install art-template</span><br></pre></td></tr></table></figure></li><li><p>模板引擎的使用</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> template = <span class="built_in">require</span>(<span class="string">&#x27;art-template&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> html = template(<span class="string">&#x27;模板路径&#x27;</span>,数据);</span><br></pre></td></tr></table></figure></li><li><p>模板引擎基础使用</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 导入模板引擎</span></span><br><span class="line"><span class="keyword">const</span> template = <span class="built_in">require</span>(<span class="string">&quot;art-template&quot;</span>);</span><br><span class="line"><span class="comment">// 引入系统模块 path</span></span><br><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">&quot;path&quot;</span>);</span><br><span class="line"><span class="comment">// 路径拼接</span></span><br><span class="line"><span class="keyword">const</span> views = path.join(__dirname, <span class="string">&quot;views&quot;</span>, <span class="string">&quot;index.art&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> html = template(views, &#123;</span><br><span class="line">  age: <span class="number">10</span>,</span><br><span class="line">  name: <span class="string">&quot;Node&quot;</span>,</span><br><span class="line">&#125;);</span><br><span class="line"><span class="built_in">console</span>.log(html);</span><br><span class="line"></span><br></pre></td></tr></table></figure> <img src="https://cdn.jsdelivr.net/gh/lovobin/FileJsDeliver@v1.1.13/gif/3.gif" data-lazy-src="https://gitee.com/wang_hong_bin/repo-bin/raw/master/arttemplate.png" width="300"></li><li><p>输出,支持运算符</p><ol><li><p>标准语法</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123; name &#125;&#125;</span><br></pre></td></tr></table></figure></li><li><p> 原始语法</p></li></ol><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;%= name %&gt;</span><br></pre></td></tr></table></figure><ol start="3"><li> 原文解析</li></ol><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">app.js:</span><br><span class="line">	&#123;</span><br><span class="line">        name: <span class="string">&quot;&lt;h3&gt;Node&lt;/h3&gt;&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">-------------------------------------</span><br><span class="line">&#123;&#123;@ name &#125;&#125; <span class="comment">// 输出: &lt;h3&gt;Node&lt;/h3&gt;</span></span><br><span class="line"> </span><br><span class="line">&lt;%- name %&gt; <span class="comment">// 输出: &lt;h3&gt;Node&lt;/h3&gt;</span></span><br><span class="line">    </span><br></pre></td></tr></table></figure></li><li><p>条件判断</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123;<span class="keyword">if</span> age&gt;<span class="number">30</span> &#125;&#125;</span><br><span class="line">年龄过大</span><br><span class="line">&#123;&#123; <span class="keyword">else</span> <span class="keyword">if</span> age&lt;<span class="number">15</span>&#125;&#125;</span><br><span class="line">&#123;&#123; age &#125;&#125;</span><br><span class="line">&#123;&#123;/<span class="keyword">if</span>&#125;&#125;</span><br></pre></td></tr></table></figure></li><li><p>循环</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123; each 数据&#125;&#125;  &#123;&#123;/each&#125;&#125;</span><br></pre></td></tr></table></figure></li><li><p>子模板</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">使用子模板可以将网站公共区块(头部、底部)抽离到单独的文件中。</span><br></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 标准语法: 引入头部</span></span><br><span class="line">&#123;&#123;include <span class="string">&#x27;./commen/header.art&#x27;</span>&#125;&#125;</span><br><span class="line"><span class="comment">// 原始语法: 引入底部</span></span><br><span class="line">&lt;% include(<span class="string">&#x27;./commen/footer.art&#x27;</span>) %&gt;</span><br></pre></td></tr></table></figure></li><li><p>模板继承</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">使用模板继承可以将网站 HTML 骨架抽离到单独文件中,其他页面模板可以继承骨架文件。</span><br></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 留坑</span></span><br><span class="line">&#123;&#123;block <span class="string">&#x27;name&#x27;</span>&#125;&#125; &#123;&#123;/block&#125;&#125;</span><br><span class="line">                   </span><br><span class="line"> <span class="comment">// 继承</span></span><br><span class="line">&#123;&#123;extend <span class="string">&#x27;path/art-template name&#x27;</span>&#125;&#125;</span><br><span class="line"><span class="comment">// 填充</span></span><br><span class="line">&#123;&#123;block <span class="string">&#x27;name&#x27;</span>&#125;&#125;  填充 &#123;&#123;/block&#125;&#125;</span><br></pre></td></tr></table></figure></li><li><p>模板配置</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1.</span> 向模板中导入变量 template.defaults.imports.变量名 = 变量值;</span><br><span class="line"><span class="number">2.</span> 设置模板根目录 template.defaults.root = 模板目录;</span><br><span class="line"><span class="number">3.</span> 设置模板默认后缀 template.defaults.extname=<span class="string">&#x27;.art&#x27;</span></span><br></pre></td></tr></table></figure></li><li><p>路由模块</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install router</span><br></pre></td></tr></table></figure><ul><li>使用步骤<ol><li>获取路由对象</li><li> 调用路由对象提供的方法创建路由</li><li> 启用路由,使路由生效</li></ol></li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">/*********************************************/</span></span><br><span class="line"><span class="comment">// 引入路由模块</span></span><br><span class="line"><span class="keyword">const</span> getRouter = <span class="built_in">require</span>(<span class="string">&quot;router&quot;</span>);</span><br><span class="line"><span class="comment">// 获取路由对象</span></span><br><span class="line"><span class="keyword">const</span> router = getRouter();</span><br><span class="line"><span class="comment">// <span class="doctag">TODO:</span>  test 路由</span></span><br><span class="line">router.get(<span class="string">&quot;/test&quot;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  res.end(<span class="string">&quot;/test&quot;</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// <span class="doctag">TODO:</span> index 路由</span></span><br><span class="line"> router.get(<span class="string">&quot;/index&quot;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  res.end(<span class="string">&quot;/index&quot;</span>);</span><br><span class="line">&#125;);</span><br><span class="line"><span class="comment">/*********************************************/</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">server.on(<span class="string">&quot;request&quot;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// 启用路由 必填参数</span></span><br><span class="line">  router(req, res, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&quot;被调用&quot;</span>);</span><br><span class="line">  &#125;);</span><br><span class="line">  <span class="comment">// 启用静态资源 fn 必填参数</span></span><br><span class="line">    serve(req, res, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    </span><br><span class="line">  &#125;);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></li><li><p>第三方模块<code>serve-static</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">功能: 实现讲台资源访问服务</span><br></pre></td></tr></table></figure><ul><li><p>下载</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install serve-static</span><br></pre></td></tr></table></figure></li><li><p>使用步骤</p><ol><li>引入 <code>serve-static</code>模块获取创建静态资源服务功能的方法</li><li> 调用方法创建静态资源服务并指定静态资源服务目录</li><li> 启用静态资源服务功能</li></ol></li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">/*********************************************/</span></span><br><span class="line"><span class="comment">// 引入静态资源模块</span></span><br><span class="line"><span class="keyword">const</span> serveStatic = <span class="built_in">require</span>(<span class="string">&quot;serve-static&quot;</span>);</span><br><span class="line"><span class="comment">// 实现静态资源访问 参数为静态资源目录</span></span><br><span class="line"><span class="keyword">const</span> serve = serveStatic(path.join(__dirname, <span class="string">&quot;public&quot;</span>));</span><br><span class="line"><span class="comment">/*********************************************/</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">server.on(<span class="string">&quot;request&quot;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 启用静态资源 fn 必填参数</span></span><br><span class="line">    serve(req, res, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    </span><br><span class="line">  &#125;);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br></pre></td></tr></table></figure></li></ul><h4 id="Express-框架"><a href="#Express-框架" class="headerlink" title="Express 框架"></a>Express 框架</h4><h5 id="express"><a href="#express" class="headerlink" title="express"></a><code>express</code></h5><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Express 是一个基于 Node 平台的 web 应用开发框架,它提供了一系列强大的特性,帮助你创建各种 web 应用</span><br></pre></td></tr></table></figure><h5 id="Express下载"><a href="#Express下载" class="headerlink" title="Express下载"></a><code>Express</code>下载</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install express</span><br></pre></td></tr></table></figure><ul><li><p>框架特性</p><ol><li>提供了方便简介的路由定义方式</li><li> 对获取 <code>HTTP</code> 请求参数进行了简化处理</li><li> 对模板引擎支持高,方便渲染动态 <code>HTML</code> 页面</li><li> 提供了中间件机制有效控制 <code>HTTP</code> 请求</li><li> 拥有大量第三方中间件对功能进行扩展</li></ol></li><li><p>使用<code>express</code></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 引入 express 框架</span></span><br><span class="line"><span class="keyword">const</span> express = <span class="built_in">require</span>(<span class="string">&#x27;express&#x27;</span>);</span><br><span class="line"><span class="comment">// 创建服务 </span></span><br><span class="line"><span class="keyword">const</span> app = express();</span><br><span class="line"><span class="comment">// 监听端口</span></span><br><span class="line">app.listen(<span class="number">3031</span>);</span><br><span class="line"></span><br></pre></td></tr></table></figure><ul><li><code>send</code>方法<ol><li><code>send</code> 方法内部会检测响应内容的类型</li><li><code>send</code> 方法会自动设置 <code>http</code> 状态码</li><li><code>send</code> 方法会帮我们自动设置响应的内容类型以及编码</li></ol></li></ul></li></ul><h5 id="中间件"><a href="#中间件" class="headerlink" title="中间件"></a>中间件</h5><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">中间件就是一堆方法,可以接受客户端发来的请求，可以对请求做出响应,也可以将请求继续交给下一个中间件继续处理。</span><br></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">app.use(<span class="string">&#x27;/index&#x27;</span>,<span class="function">(<span class="params">req,res,next</span>)=&gt;</span>&#123;</span><br><span class="line">    <span class="comment">// 调用 index 走该中间件</span></span><br><span class="line">    next();</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><ol><li><p><code>app.use</code>匹配所有的请求方式,可以直接传入请求处理函数，代表接受所有的请求</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">app.use(<span class="function">(<span class="params">req,res,next</span>)=&gt;</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(req.url);</span><br><span class="line">    next();</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure></li><li><p> <code>app.use</code>第一个参数也可以传入地址，代表不论什么请求方式,只要是这个请求地址就接受这个请求</p></li></ol><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">app.use(<span class="string">&#x27;/index&#x27;</span>,<span class="function">(<span class="params">req,res,next</span>)=&gt;</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(req.url);</span><br><span class="line">    next();</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h5 id="中间件的应用"><a href="#中间件的应用" class="headerlink" title="中间件的应用"></a>中间件的应用</h5><ol><li> 路由保护，客户端在访问需要登录的页面时，可以先使用中间件判断用户登录状态,用户如果未登录,直接响应,禁止用户进入需要登录的页面</li></ol><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">// 中间件</span></span><br><span class="line">app.use(<span class="string">&quot;/admin&quot;</span>, <span class="function">(<span class="params">req, res, next</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// 用户没有登录</span></span><br><span class="line">  <span class="keyword">let</span> isLogin = <span class="literal">true</span>;</span><br><span class="line">  <span class="keyword">if</span> (isLogin) &#123;</span><br><span class="line">    <span class="comment">// true 就是登录 如果登录继续向下执行</span></span><br><span class="line">    next();</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="comment">// 如果用户没有登陆.直接对客户端做出响应</span></span><br><span class="line">    res.send(<span class="string">&quot;请登录·········&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  app.get(<span class="string">&quot;/admin&quot;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">    res.end(<span class="string">&quot;你已登陆·····&quot;</span>);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><ol start="2"><li><p> 网站维护公告,在所有路由的最上面定义接收所有请求的中间件，直接为客户端做出响应，网站正在维护中</p></li><li><p> 自定义<code>404页面</code></p></li></ol><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">app.use(<span class="function">(<span class="params">req, res, next</span>) =&gt;</span> &#123;</span><br><span class="line">  res.status(<span class="number">404</span>).send(<span class="string">&quot;当前访问页面不存在&quot;</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><h5 id="错误处理中间件"><a href="#错误处理中间件" class="headerlink" title="错误处理中间件"></a>错误处理中间件</h5><blockquote><p>在程序执行的过程中,不可避免的会出现一些无法预料的错误,比如文件读取失败,数据库连接失败,错误处理中间件是一个集中处理错误的地方</p></blockquote><ul><li><p>基本使用</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">app.get(<span class="string">&quot;/list&quot;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// 抛出异常</span></span><br><span class="line">  <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">&quot;程序发生了未知错误&quot;</span>);</span><br><span class="line"> <span class="comment">// res.end(&quot;程序正常执行&quot;);</span></span><br><span class="line">&#125;);</span><br><span class="line"><span class="comment">// 错误处理中间件</span></span><br><span class="line">app.use(<span class="function">(<span class="params">err, req, res, next</span>) =&gt;</span> &#123;</span><br><span class="line">  res.status(<span class="number">500</span>).send(err.message);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></li></ul><h5 id="捕获错误"><a href="#捕获错误" class="headerlink" title="捕获错误"></a>捕获错误</h5><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">try</span> <span class="keyword">catch</span> 可以捕获异步函数以及其他同步代码在执行过程中发生的错误,但是不能其他类型的 API 发生的错误。</span><br></pre></td></tr></table></figure><h5 id="Express-请求处理"><a href="#Express-请求处理" class="headerlink" title="Express 请求处理"></a>Express 请求处理</h5><ul><li><p>构建模块化路由</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*******************************/</span></span><br><span class="line"><span class="comment">// 路由</span></span><br><span class="line">index.js:</span><br><span class="line">    <span class="comment">// 创建路由对象</span></span><br><span class="line">    <span class="keyword">const</span> index = express.Router();</span><br><span class="line">    <span class="comment">// 为路由对象匹配请求路径</span></span><br><span class="line">    app.use(<span class="string">&quot;/index&quot;</span>, index);</span><br><span class="line">    <span class="comment">// 创建二级路由</span></span><br><span class="line">    index.get(<span class="string">&quot;/home&quot;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">      res.send(<span class="string">&quot;Blog home Index&quot;</span>);</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="built_in">module</span>.exports = index;</span><br><span class="line"><span class="comment">/*******************************/</span></span><br><span class="line">app.js:</span><br><span class="line">	<span class="keyword">const</span> index = <span class="built_in">require</span>(<span class="string">&#x27;path/index.js&#x27;</span>);</span><br><span class="line">	<span class="comment">// index/home: Blog home Index</span></span><br><span class="line">	app.use(<span class="string">&#x27;/home&#x27;</span>,index);</span><br><span class="line"><span class="comment">/*******************************/</span></span><br></pre></td></tr></table></figure></li></ul><h5 id="GET请求参数处理"><a href="#GET请求参数处理" class="headerlink" title="GET请求参数处理"></a>GET请求参数处理</h5><blockquote><p><code>Express</code> 框架中使用 <code>req.query</code>即可获取 <code>GET</code>参数,框架内部会将 <code>GET</code>请求参数转换为对象并返回</p></blockquote><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">app.get(<span class="string">&#x27;/index&#x27;</span>,<span class="function">(<span class="params">req,res</span>)=&gt;</span>&#123;</span><br><span class="line">    res.send(req.url);</span><br><span class="line">  <span class="built_in">console</span>.log(req.query); <span class="comment">// &#123; name: &#x27;zhangsan&#x27;, age: &#x27;10&#x27; &#125;</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><h5 id="POST-请求参数处理"><a href="#POST-请求参数处理" class="headerlink" title="POST 请求参数处理"></a>POST 请求参数处理</h5><blockquote><p>第三方模块: <code>npm install body-parser</code></p></blockquote><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 引入第三方模块</span></span><br><span class="line"><span class="keyword">const</span> bodyParser = <span class="built_in">require</span>(<span class="string">&quot;body-parser&quot;</span>);</span><br><span class="line"><span class="comment">// 配置</span></span><br><span class="line">app.use(bodyParser.urlencoded(&#123; <span class="attr">extended</span>: <span class="literal">false</span> &#125;));</span><br><span class="line"></span><br><span class="line">app.post(<span class="string">&quot;/index&quot;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  res.send(req.url);</span><br><span class="line">  <span class="built_in">console</span>.log(req.body); <span class="comment">// [Object: null prototype] &#123; username: &#x27;qw&#x27;, pwd: &#x27;sa&#x27; &#125;</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 解释</span></span><br><span class="line">app.use(bodyParser.urlencoded(&#123; <span class="attr">extended</span>: <span class="literal">false</span> &#125;));</span><br><span class="line"></span><br><span class="line"><span class="comment">// 拦截所有请求参数</span></span><br><span class="line">extended: <span class="literal">false</span> 方法内部使用 querystring 模块处理请求参数的格式</span><br><span class="line">extended: <span class="literal">true</span> 方法内部使用第三方模块 qs 处理请求参数的格式</span><br><span class="line"></span><br></pre></td></tr></table></figure><h5 id="Express-路由参数"><a href="#Express-路由参数" class="headerlink" title="Express 路由参数"></a>Express 路由参数</h5><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">app.get(<span class="string">&quot;/index/:id&quot;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(req.params); </span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><h5 id="Express-静态资源处理"><a href="#Express-静态资源处理" class="headerlink" title="Express 静态资源处理"></a>Express 静态资源处理</h5><ul><li><p>静态资源</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">通过 Express 内置的 express.static 可以方便地托管静态文件,例如 img,css,javascript 文件等。</span><br></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> pathname = path.join(__dirname, <span class="string">&quot;public&quot;</span>);</span><br><span class="line"><span class="comment">// 实现静态资源访问功能</span></span><br><span class="line">app.use(express.static(pathname));</span><br><span class="line"></span><br><span class="line"><span class="comment">// 访问: http://127.0.0.1:3031/[default.html]</span></span><br></pre></td></tr></table></figure></li></ul><h5 id="模板引擎-1"><a href="#模板引擎-1" class="headerlink" title="模板引擎"></a>模板引擎</h5><ol><li><p>模板引擎</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">为了使 <span class="string">`art-template`</span>模板引擎能够更好的和<span class="string">`Express`</span>框架结合,模板引擎官方在原 <span class="string">`art-template`</span> 模板引擎的基础上封装了<span class="string">`express-art-template`</span></span><br></pre></td></tr></table></figure></li><li><p> 下载</p></li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install art-template express-art-template </span><br></pre></td></tr></table></figure><ol start="3"><li> 使用</li></ol><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//*********************************</span></span><br><span class="line"><span class="comment">// 模板引擎的使用</span></span><br><span class="line"><span class="comment">//*********************************</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> express = <span class="built_in">require</span>(<span class="string">&quot;express&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> app = express();</span><br><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">&quot;path&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 1. 告诉 express 框架使用什么模板引擎渲染什么后缀的模板文件</span></span><br><span class="line">app.engine(<span class="string">&quot;art&quot;</span>, <span class="built_in">require</span>(<span class="string">&quot;express-art-template&quot;</span>));</span><br><span class="line"><span class="comment">// 2. 告诉 express 框架模板存放的位置</span></span><br><span class="line">app.set(<span class="string">&quot;views&quot;</span>, path.join(__dirname, <span class="string">&quot;views&quot;</span>));</span><br><span class="line"><span class="comment">// 3. 告诉 express 框架模板的默认后缀是什么</span></span><br><span class="line">app.set(<span class="string">&quot;view engine&quot;</span>, <span class="string">&quot;art&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 创建一个路由</span></span><br><span class="line">app.get(<span class="string">&quot;/index&quot;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  res.render(<span class="string">&quot;index&quot;</span>, &#123;</span><br><span class="line">    msg: <span class="string">&quot;message&quot;</span>,</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">app.listen(<span class="number">3031</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">&quot;服务器启动成功··················&quot;</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="Node-深入补充"><a href="#Node-深入补充" class="headerlink" title="Node 深入补充"></a>Node 深入补充</h3><h4 id="系统模块-1"><a href="#系统模块-1" class="headerlink" title="系统模块"></a>系统模块</h4><h5 id="读取目录树"><a href="#读取目录树" class="headerlink" title="读取目录树"></a>读取目录树</h5><ul><li><p><code>R</code></p><details><summary> 文件读取</summary><div class="content"><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">  <span class="comment">// 同步读取文件</span></span><br><span class="line">  <span class="keyword">let</span> dirs = fs.readdirSync(<span class="string">&quot;./&quot;</span>);</span><br><span class="line">  <span class="built_in">console</span>.log(dirs); <span class="comment">// 需要捕获异常</span></span><br><span class="line">  </span><br><span class="line">  -------------------------- 改进 ------------------------------------</span><br><span class="line">  </span><br><span class="line">  <span class="comment">//捕获同步执行异常 </span></span><br><span class="line">  <span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="comment">// 可能出现错误的代码</span></span><br><span class="line">    <span class="keyword">let</span> dirtree = fs.readdirSync(<span class="string">&quot;./&quot;</span>);</span><br><span class="line">    <span class="built_in">console</span>.log(dirtree);</span><br><span class="line">  &#125; <span class="keyword">catch</span> (err) &#123;</span><br><span class="line">    <span class="comment">// 错误后执行的代码</span></span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&quot;执行出错,请仔细阅读错误信息: &quot;</span>, err);</span><br><span class="line">  &#125;</span><br><span class="line">  ------------------------------------------------------------------</span><br><span class="line">  </span><br><span class="line">  <span class="comment">// 异步读取</span></span><br><span class="line">  fs.readdir(<span class="string">&quot;./&quot;</span>, <span class="function">(<span class="params">err, data</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// 错误的回调函数优先,在回调函数中第一个参数表示错误对象 默认为 null 如果出现错误 err 就是错误对象</span></span><br><span class="line">    <span class="keyword">if</span> (err) &#123;</span><br><span class="line">      <span class="built_in">console</span>.log(<span class="string">&quot;请重新尝试: &quot;</span>, err);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="built_in">console</span>.log(data);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></div></details></li></ul><h5 id="创建目录"><a href="#创建目录" class="headerlink" title="创建目录"></a>创建目录</h5><ul><li><p><code>C</code></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 创建文件夹</span></span><br><span class="line">fs.mkdir(<span class="string">&quot;../qf-Node-day02&quot;</span>, <span class="function">(<span class="params">err</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">if</span> (err) &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(err);</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&quot;文件夹创建成功&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></li></ul><h5 id="更改"><a href="#更改" class="headerlink" title="更改"></a>更改</h5><ul><li><p><code>U</code></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 更改文件夹</span></span><br><span class="line">fs.rename(<span class="string">&quot;../qf-Node-day03&quot;</span>, <span class="string">&quot;../qf-Node-day02&quot;</span>, <span class="function">(<span class="params">err</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">if</span> (err) &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(err);</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&quot;重命名成功&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br></pre></td></tr></table></figure></li></ul><h5 id="删除"><a href="#删除" class="headerlink" title="删除"></a>删除</h5><ul><li><p><code>D</code></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 删除文件夹 只能删除空文件夹</span></span><br><span class="line">fs.rmdir(<span class="string">&quot;../qf-Node-day02&quot;</span>, <span class="function">(<span class="params">err</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">if</span> (err) &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(err);</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&quot;文件夹删除成功&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br></pre></td></tr></table></figure></li></ul><h5 id="文件读写删除"><a href="#文件读写删除" class="headerlink" title="文件读写删除"></a>文件读写删除</h5><ul><li><p>读写</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 文件写入</span></span><br><span class="line">fs.writeFile(<span class="string">&quot;./writeJs.js&quot;</span>, <span class="string">&quot;// Node JS written successfully&quot;</span>, <span class="function">(<span class="params">err</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">if</span> (err) &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(err);</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    fs.readFile(<span class="string">&quot;./writeJs.js&quot;</span>, <span class="function">(<span class="params">err, data</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">if</span> (err) &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(err);</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(data.toString(<span class="string">&#x27;utf8&#x27;</span>));</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></li><li><p>删除文件</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">fs.unlink(<span class="string">&quot;./writeJs.js&quot;</span>, <span class="function">(<span class="params">err</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">if</span> (err) &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(err);</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&quot;文件已删除&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br></pre></td></tr></table></figure></li></ul><h5 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h5><ul><li><p><code>url</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">统一资源定位符</span><br></pre></td></tr></table></figure></li><li><p>图解</p> <img src="https://cdn.jsdelivr.net/gh/lovobin/FileJsDeliver@v1.1.13/gif/3.gif" data-lazy-src="https://gitee.com/wang_hong_bin/repo-bin/raw/master/url.png"></li><li><p><code>url.parse</code></p><details><summary> url.parse</summary><div class="content"><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">const</span> url = <span class="built_in">require</span>(<span class="string">&#x27;url&#x27;</span>);</span><br><span class="line"><span class="keyword">let</span> urlpath = <span class="string">&#x27;https://www.bilibili.com/video/BV13E411y7G4?p=7&amp;spm_id_from=pageDriver&#x27;</span>;</span><br><span class="line"><span class="keyword">let</span> urlparse = url.parse(urlpath);</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(urlparse);</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">Url &#123;</span></span><br><span class="line"><span class="comment">  protocol: &#x27;https:&#x27;,</span></span><br><span class="line"><span class="comment">  slashes: true,</span></span><br><span class="line"><span class="comment">  auth: null,</span></span><br><span class="line"><span class="comment">  host: &#x27;www.bilibili.com&#x27;,    </span></span><br><span class="line"><span class="comment">  port: null,</span></span><br><span class="line"><span class="comment">  hostname: &#x27;www.bilibili.com&#x27;,</span></span><br><span class="line"><span class="comment">  hash: null,</span></span><br><span class="line"><span class="comment">  search: &#x27;?p=7&amp;spm_id_from=pageDriver&#x27;,</span></span><br><span class="line"><span class="comment">  query: &#x27;p=7&amp;spm_id_from=pageDriver&#x27;,</span></span><br><span class="line"><span class="comment">  pathname: &#x27;/video/BV13E411y7G4&#x27;,</span></span><br><span class="line"><span class="comment">  path: &#x27;/video/BV13E411y7G4?p=7&amp;spm_id_from=pageDriver&#x27;,</span></span><br><span class="line"><span class="comment">  href: &#x27;https://www.bilibili.com/video/BV13E411y7G4?p=7&amp;spm_id_from=pageDriver&#x27;</span></span><br><span class="line"><span class="comment">&#125;</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure></div></details><ul><li><p>将对象转换为字符串</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 将对象转换为字符串</span></span><br><span class="line"><span class="keyword">let</span> strurl = url.format(urlparse);</span><br><span class="line"><span class="built_in">console</span>.log(strurl); <span class="comment">//  https://www.bilibili.com/video/BV13E411y7G4?p=7&amp;spm_id_from=pageDriver</span></span><br><span class="line"></span><br></pre></td></tr></table></figure></li><li><p>获取<code>url</code>参数</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 获取对象参数的值</span></span><br><span class="line"><span class="keyword">let</span> params = url.parse(urlpath, <span class="literal">true</span>).query;</span><br><span class="line"><span class="built_in">console</span>.log(params);</span><br><span class="line"></span><br></pre></td></tr></table></figure></li></ul></li><li><p><code>quertstring</code></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">const</span> qs = <span class="built_in">require</span>(<span class="string">&quot;querystring&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 基本使用</span></span><br><span class="line"><span class="keyword">let</span> str = <span class="string">&quot;p=7&amp;spm_id_from=pageDriver&quot;</span>;</span><br><span class="line"><span class="built_in">console</span>.log(qs.parse(str)); <span class="comment">// [Object: null prototype] &#123; p: &#x27;7&#x27;, spm_id_from: &#x27;pageDriver&#x27; &#125;</span></span><br><span class="line"></span><br><span class="line">-------------------------------------------------------------------------------------------------</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 添加参数</span></span><br><span class="line"><span class="keyword">let</span> newStr = <span class="string">&quot;p*7#spm_id_from*pageDriver&quot;</span>;</span><br><span class="line"><span class="comment">// * # 为 query 的显示方式,而使用该方式进行解析</span></span><br><span class="line"><span class="keyword">let</span> obj = qs.parse(newStr, <span class="string">&quot;#&quot;</span>, <span class="string">&quot;*&quot;</span>);</span><br><span class="line"><span class="built_in">console</span>.log(obj); <span class="comment">// [Object: null prototype] &#123; p: &#x27;7&#x27;, spm_id_from: &#x27;pageDriver&#x27; &#125;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure></li><li><p><code>stringfy</code></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// stringfy</span></span><br><span class="line"><span class="keyword">let</span> jsonS = &#123; <span class="attr">p</span>: <span class="string">&quot;7&quot;</span>, <span class="attr">spm_id_from</span>: <span class="string">&quot;pageDriver&quot;</span> &#125;;</span><br><span class="line"><span class="keyword">var</span> jsonStr = qs.stringify(jsonS);</span><br><span class="line"><span class="built_in">console</span>.log(jsonStr); <span class="comment">// p=7&amp;spm_id_from=pageDriver</span></span><br></pre></td></tr></table></figure></li><li><p><code>nodemailer</code></p><div class="hide-block"><button type="button" class="hide-button button--animated" style="">请勿尝-了解知识</button><div class="hide-content"><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// npm install nodemailer</span></span><br><span class="line"><span class="meta">&quot;use strict&quot;</span>;</span><br><span class="line"><span class="keyword">const</span> nodemailer = <span class="built_in">require</span>(<span class="string">&quot;nodemailer&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 创建发送邮件对象</span></span><br><span class="line"><span class="keyword">let</span> transporter = nodemailer.createTransport(&#123;</span><br><span class="line">  host: <span class="string">&quot;smtp.qq.com&quot;</span>, <span class="comment">// 发送方邮箱类型: QQ 网易 ···</span></span><br><span class="line">  port: <span class="number">465</span>,</span><br><span class="line">  secure: <span class="literal">true</span>, <span class="comment">//  true for 465, false for other ports</span></span><br><span class="line">  auth: &#123;</span><br><span class="line">    user: <span class="string">&#x27;xxx@qq.com&#x27;</span>, <span class="comment">// 发送方邮箱地址</span></span><br><span class="line">    pass: <span class="string">&#x27;&#x27;</span>, <span class="comment">// smtp 验证码</span></span><br><span class="line">  &#125;,</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 邮件信息</span></span><br><span class="line"><span class="keyword">let</span> mailobj = &#123;</span><br><span class="line">  <span class="keyword">from</span>: <span class="string">&quot;&lt;xxx@qq.com&gt;&quot;</span>, <span class="comment">// 邮件发送地址</span></span><br><span class="line">  to: <span class="string">&quot;xxx@qq.com&quot;</span>,</span><br><span class="line">  subject: <span class="string">&quot;Node 发送邮箱测试&quot;</span>, <span class="comment">// 标题</span></span><br><span class="line">  text: <span class="string">&quot;发送成功 Node Message&quot;</span>, <span class="comment">// text 和 html 选其一作为发送文本</span></span><br><span class="line">  html: <span class="string">&quot;&lt;h1&gt; 发送成功 Node Message &lt;/h1&gt;&quot;</span>,</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 发送邮件</span></span><br><span class="line">transporter.sendMail(mailobj,<span class="function">(<span class="params">err,data</span>)=&gt;</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(err)&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(err);</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(date);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></div></div></li></ul><h4 id="Express-路由"><a href="#Express-路由" class="headerlink" title="Express 路由"></a>Express 路由</h4><ul><li><p>路由下载</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install router</span><br></pre></td></tr></table></figure></li><li><p>拆解路由</p><details><summary> 路由</summary><div class="content"><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">router: /userRouter</span><br><span class="line">		userRouter:</span><br><span class="line">			<span class="keyword">const</span> express = <span class="built_in">require</span>(<span class="string">&quot;express&quot;</span>);</span><br><span class="line">			<span class="keyword">const</span> router = express.Router();</span><br><span class="line">			<span class="comment">// user api </span></span><br><span class="line"> 			router.get(<span class="string">&#x27;/login&#x27;</span>,<span class="function">(<span class="params">req,res</span>)=&gt;</span>&#123;</span><br><span class="line">                res.send(&#123;</span><br><span class="line">                    code: <span class="number">1</span>,</span><br><span class="line">                    ps: <span class="string">&#x27;login ok&#x27;</span></span><br><span class="line">                &#125;);</span><br><span class="line">            &#125;);</span><br><span class="line"> 		<span class="built_in">module</span>.exports = router;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">-------------------------------------------------------------------------    </span><br><span class="line">    </span><br><span class="line">app.js:</span><br><span class="line">	<span class="keyword">const</span> express = <span class="built_in">require</span>(<span class="string">&quot;express&quot;</span>);</span><br><span class="line">	<span class="keyword">const</span> app = express();</span><br><span class="line">	<span class="comment">// 引入拆分路由</span></span><br><span class="line">	<span class="keyword">const</span> userRouter = <span class="built_in">require</span>(<span class="string">&#x27;./router/userRouter&#x27;</span>);</span><br><span class="line">	<span class="comment">// 使用路由</span></span><br><span class="line">	app.use(<span class="string">&#x27;/user&#x27;</span>,userRouter);</span><br><span class="line">	</span><br><span class="line">解析:</span><br><span class="line">	app.use(<span class="string">&#x27;/user&#x27;</span>,userRouter);</span><br><span class="line"></span><br><span class="line">	http:<span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>:<span class="number">3031</span>/user/【截取: 进入 userRouter 中寻找请求路由地址 eg: /login ]</span><br><span class="line"></span><br><span class="line">	所以最终请求地址为: 	http:<span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>:<span class="number">3031</span>/user/login</span><br></pre></td></tr></table></figure></div></details></li></ul><h4 id="模板引擎-2"><a href="#模板引擎-2" class="headerlink" title="模板引擎"></a>模板引擎</h4><h5 id="模板引擎下载"><a href="#模板引擎下载" class="headerlink" title="模板引擎下载"></a>模板引擎下载</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install art-template --save </span><br></pre></td></tr></table></figure><h5 id="使用模板引擎"><a href="#使用模板引擎" class="headerlink" title="使用模板引擎"></a>使用模板引擎</h5><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> template = <span class="built_in">require</span>(<span class="string">&quot;art-template&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> fs = <span class="built_in">require</span>(<span class="string">&quot;fs&quot;</span>);</span><br><span class="line"><span class="comment">// 读取 art.html 字符串模板</span></span><br><span class="line">fs.readFile(<span class="string">&quot;./public/art.html&quot;</span>, <span class="function">(<span class="params">err, data</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">if</span> (err) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">console</span>.log(<span class="string">&quot;读取失败&quot;</span>);</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="comment">// 渲染模板引擎</span></span><br><span class="line">    <span class="keyword">let</span> templateRes = template.render(data.toString(),&#123;</span><br><span class="line">        name: <span class="string">&quot;李四&quot;</span></span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="built_in">console</span>.log(templateRes);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br></pre></td></tr></table></figure><h4 id="包说明文件"><a href="#包说明文件" class="headerlink" title="包说明文件"></a>包说明文件</h4><ul><li><p><code>package.json</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">npm init -y</span><br><span class="line"></span><br><span class="line">npm install package-name --save</span><br><span class="line">--save: 可以将包添加到 package.json 中的 dependencies 选项中</span><br><span class="line">注意: 建议每个项目都有 package.json 文件</span><br><span class="line"></span><br></pre></td></tr></table></figure></li></ul><h4 id="NPM"><a href="#NPM" class="headerlink" title="NPM"></a>NPM</h4><ul><li><p><code>npm</code>官网</p><p><a target="_blank" rel="noopener" href="https://www.npmjs.com/">点击前往 npm 官网 </a></p></li><li><p><code>npm</code>命令行管理工具</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install package-name --save</span><br></pre></td></tr></table></figure></li><li><p><code>npm</code>升级</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install --global npm</span><br></pre></td></tr></table></figure></li></ul><h4 id="Express"><a href="#Express" class="headerlink" title="Express"></a>Express</h4><h5 id="下载"><a href="#下载" class="headerlink" title="下载"></a>下载</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install express</span><br></pre></td></tr></table></figure><h5 id="使用"><a href="#使用" class="headerlink" title="使用"></a>使用</h5><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> express = <span class="built_in">require</span>(<span class="string">&#x27;express&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> app = express();</span><br><span class="line">app.listen(<span class="string">&#x27;端口号&#x27;</span>,<span class="string">&#x27;回调函数&#x27;</span>);</span><br></pre></td></tr></table></figure><h5 id="静态资源文件路径开放问题"><a href="#静态资源文件路径开放问题" class="headerlink" title="静态资源文件路径开放问题"></a>静态资源文件路径开放问题</h5><ul><li><p><code>express</code>中静态资源路径处理</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 开放静态资源路径 访问方式: 127.0.0.1:3031/public/file-name</span></span><br><span class="line">app.use(<span class="string">&quot;/public&quot;</span>, express.static(<span class="string">&quot;./public/&quot;</span>));</span><br><span class="line"></span><br><span class="line"><span class="comment">// 当省略第一个参数的时候可以省略 /public 的方式访问 访问方式: 127.0.0.1:3031/file-name</span></span><br><span class="line">app.use(express.static(<span class="string">&quot;./public/&quot;</span>)); </span><br><span class="line"></span><br><span class="line"><span class="comment">// 疑惑: path.join() 暂时理解有误 拼接使用错误</span></span><br><span class="line"><span class="keyword">let</span> filepath = path.join(__dirname,<span class="string">&quot;public&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure> <img src="https://cdn.jsdelivr.net/gh/lovobin/FileJsDeliver@v1.1.13/gif/3.gif" data-lazy-src="https://img-blog.csdnimg.cn/20210228132814369.gif" title="express-开放静态资源路径" width="700"></li></ul><h4 id="GET请求参数处理案例"><a href="#GET请求参数处理案例" class="headerlink" title="GET请求参数处理案例"></a>GET请求参数处理案例</h4><ul><li><p><code>app.js</code></p><details><summary> app.js</summary><div class="content"><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> fs = <span class="built_in">require</span>(<span class="string">&quot;fs&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> url = <span class="built_in">require</span>(<span class="string">&quot;url&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> template = <span class="built_in">require</span>(<span class="string">&quot;art-template&quot;</span>);</span><br><span class="line"><span class="comment">// 创建 express 服务器</span></span><br><span class="line"><span class="keyword">const</span> express = <span class="built_in">require</span>(<span class="string">&quot;express&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> app = express();</span><br><span class="line"></span><br><span class="line"><span class="comment">// 开放静态资源路径 访问方式: 127.0.0.1:3031/public/file-name</span></span><br><span class="line"><span class="comment">// app.use(&quot;/public&quot;, express.static(&quot;./public/&quot;));</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 当省略第一个参数的时候 可以省略 /public 的方式访问</span></span><br><span class="line">app.use(express.static(<span class="string">&quot;./public/&quot;</span>)); <span class="comment">// 127.0.0.1:3031/file-name</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// index router</span></span><br><span class="line">app.get(<span class="string">&quot;/index&quot;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// 读取文件</span></span><br><span class="line">  fs.readFile(<span class="string">&quot;public/index.html&quot;</span>, <span class="function">(<span class="params">err, data</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (err) &#123;</span><br><span class="line">      <span class="built_in">console</span>.log(err);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="keyword">let</span> resoult = template.render(data.toString());</span><br><span class="line">      res.send(resoult);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">/* ************************************* */</span></span><br><span class="line"><span class="keyword">let</span> comments = [];</span><br><span class="line"><span class="comment">/* ************************************* */</span></span><br><span class="line"></span><br><span class="line">app.get(<span class="string">&quot;/pinglun&quot;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// 读取 pinglun.html</span></span><br><span class="line">  fs.readFile(<span class="string">&quot;public/pinglun.html&quot;</span>, <span class="function">(<span class="params">err, data</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (err) &#123;</span><br><span class="line">      <span class="built_in">console</span>.log(<span class="string">&quot;文件读取失败&quot;</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="comment">// 解析 get 参数数据</span></span><br><span class="line">      <span class="keyword">let</span> parserObj = url.parse(req.url, <span class="literal">true</span>);</span><br><span class="line">      <span class="keyword">let</span> pathname = parserObj.pathname; <span class="comment">//  /pinglun</span></span><br><span class="line">      <span class="built_in">console</span>.log(pathname);</span><br><span class="line">      <span class="keyword">let</span> comment = parserObj.query; <span class="comment">// ? 后面的数据 &#123; username: &#x27;asd&#x27;, message: &#x27;dsadad&#x27; &#125;</span></span><br><span class="line">      <span class="comment">// 追加到数组中 服务器端这个时候已经把数据存储好了 接下来就是让用户重新请求 / 首页</span></span><br><span class="line">      comments.unshift(comment);</span><br><span class="line"></span><br><span class="line">      <span class="comment">// 重定向问题</span></span><br><span class="line">      <span class="comment">// 如何通过服务器让客户端重定向</span></span><br><span class="line">      <span class="comment">// 1. 状态码设置为 302 临时重定向</span></span><br><span class="line">      <span class="comment">// statusCode</span></span><br><span class="line">      <span class="comment">// 2. 在响应头中通过 Location 告诉客户端往哪儿重定向</span></span><br><span class="line">      <span class="comment">// setHeader</span></span><br><span class="line">      <span class="comment">// res.statusCode = 302;</span></span><br><span class="line">      <span class="comment">// res.setHeader(&quot;Location&quot;, &quot;/&quot;);</span></span><br><span class="line">      <span class="comment">// res.send();</span></span><br><span class="line">      <span class="comment">// 模板字符串</span></span><br><span class="line">      <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; comments.length; i++) &#123;</span><br><span class="line">        <span class="keyword">let</span> templateP = template.render(data.toString(), &#123;</span><br><span class="line">          username: comments[i][<span class="string">&quot;username&quot;</span>],</span><br><span class="line">          message: comments[i][<span class="string">&quot;message&quot;</span>],</span><br><span class="line">        &#125;);</span><br><span class="line">        res.send(templateP);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 监听端口号</span></span><br><span class="line">app.listen(<span class="number">3031</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">&quot;服务器启动成功··········&quot;</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 缺点: 未能对 get 表单参数进行截取 只能读取一条数据</span></span><br><span class="line"></span><br></pre></td></tr></table></figure></div></details></li><li><p>实现效果</p> <img src="https://cdn.jsdelivr.net/gh/lovobin/FileJsDeliver@v1.1.13/gif/3.gif" data-lazy-src="https://gitee.com/wang_hong_bin/repo-bin/raw/master/NodeGetData.gif" width="800" title="GET 表单数据处理"></li><li><p>完善<code>BUG</code></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">问题原因: 在模板字符串渲染参数给中对第二个参数传递时理解有误</span><br><span class="line"></span><br><span class="line">解决方案；</span><br><span class="line">     <span class="keyword">let</span> templateP = template.render(data.toString(), &#123;</span><br><span class="line">         <span class="comment">// comments --&gt; 参数名称 comments--&gt; 数组 而这个数组包含对象 [&#123;&#125;,···]</span></span><br><span class="line">         comments: comments,</span><br><span class="line">          &#125;);</span><br><span class="line">          res.send(templateP);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 模板字符串</span></span><br><span class="line"> &#123;&#123;each comments&#125;&#125;</span><br><span class="line">          &lt;tr&gt;</span><br><span class="line">            &lt;td&gt;<span class="number">2021</span>-<span class="number">02</span>-<span class="number">28</span>&lt;/td&gt;</span><br><span class="line">            &lt;td&gt;&#123;&#123;$value.username&#125;&#125;&lt;/td&gt;</span><br><span class="line">            &lt;td&gt;&#123;&#123;$value.message&#125;&#125;&lt;/td&gt;</span><br><span class="line">          &lt;/tr&gt;</span><br><span class="line"> &#123;&#123;/each&#125;&#125;</span><br><span class="line">            </span><br><span class="line"><span class="comment">// 缺陷: 未添加重定向</span></span><br></pre></td></tr></table></figure> <img src="https://cdn.jsdelivr.net/gh/lovobin/FileJsDeliver@v1.1.13/gif/3.gif" data-lazy-src="https://gitee.com/wang_hong_bin/repo-bin/raw/master/fixBug.gif" title="修复第一次由于参数传递错误引起的bug" width="800"></li></ul><ul><li><p>个人案例源码参考</p><p> <a target="_blank" rel="noopener" href="https://github.com/lovobin/Bin-HTML5/tree/main/Node/node-day10"> 点击前往 查看 </a></p></li></ul><h4 id="模板引擎-3"><a href="#模板引擎-3" class="headerlink" title="模板引擎"></a>模板引擎</h4><h5 id="下载模板引擎"><a href="#下载模板引擎" class="headerlink" title="下载模板引擎"></a>下载模板引擎</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">// 一次性下载多个包</span><br><span class="line">npm i art-template express-art-template -S</span><br><span class="line"></span><br><span class="line">// 单独下载</span><br><span class="line">npm install art-template --save</span><br><span class="line">npm install express-art-template --save</span><br><span class="line"></span><br></pre></td></tr></table></figure><h5 id="配置art-template"><a href="#配置art-template" class="headerlink" title="配置art-template"></a>配置<code>art-template</code></h5><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 配置使用 art-template art--&gt;: 可以修改为支持语法高亮的后缀文件 比如: html </span></span><br><span class="line">app.engine(<span class="string">&#x27;art&#x27;</span>,<span class="built_in">require</span>(<span class="string">&#x27;express-art-template&#x27;</span>))</span><br><span class="line"></span><br><span class="line">第一个参数: 表示 当渲染以 .art 结尾的文件的时候,使用 art-template 模板引擎</span><br><span class="line"></span><br><span class="line">express-art-template 是专门用来在 Express 中把 art-template 整合到 Express 中</span><br><span class="line"></span><br><span class="line">必须下载 art-template 原因就在于 express-art-template 依赖了 art-template </span><br><span class="line"></span><br></pre></td></tr></table></figure><h5 id="使用art-template"><a href="#使用art-template" class="headerlink" title="使用art-template"></a>使用<code>art-template</code></h5><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">Express 为 Response 响应对象提供了一个方法: render</span><br><span class="line"></span><br><span class="line">render 方法默认是不可以使用的,但是如果配置了模板引擎就可以使用了</span><br><span class="line"></span><br><span class="line"><span class="comment">// html 模板名必须和上面一致的后缀 统一放在 views 目录中 ,views 中有目录就需要根据目录依次书写文件路径 默认 views/</span></span><br><span class="line">res.render(<span class="string">&#x27;html模板名&#x27;</span>,&#123;模板数据&#125;);</span><br><span class="line"></span><br><span class="line">第一个参数不能写路径,默认会去项目中的 views 目录中查找该模板文件</span><br><span class="line"></span><br><span class="line">注意: 在Express中: 开发人员把所有的试图文件都放到 views 目录中</span><br><span class="line"></span><br></pre></td></tr></table></figure> <img src="https://cdn.jsdelivr.net/gh/lovobin/FileJsDeliver@v1.1.13/gif/3.gif" data-lazy-src="https://gitee.com/wang_hong_bin/repo-bin/raw/master/expressarttemplate.png" width="800"><h5 id="配置views目录"><a href="#配置views目录" class="headerlink" title="配置views目录"></a>配置<code>views</code>目录</h5><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">app.set(<span class="string">&#x27;views&#x27;</span>,render函数的默认路径); <span class="comment">// 第一个参数必须是 views </span></span><br></pre></td></tr></table></figure><h4 id="POST-表单数据处理"><a href="#POST-表单数据处理" class="headerlink" title="POST 表单数据处理"></a>POST 表单数据处理</h4><ul><li><p><code>app.js</code></p><details><summary> app.js</summary><div class="content"><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 引入 express 框架</span></span><br><span class="line"><span class="keyword">const</span> express = <span class="built_in">require</span>(<span class="string">&quot;express&quot;</span>);</span><br><span class="line"><span class="comment">// 创建服务</span></span><br><span class="line"><span class="keyword">const</span> app = express();</span><br><span class="line"></span><br><span class="line"><span class="comment">// 配置解析 post 表单的中间件</span></span><br><span class="line"><span class="keyword">const</span> bodyparser = <span class="built_in">require</span>(<span class="string">&quot;body-parser&quot;</span>);</span><br><span class="line">app.use(bodyparser.urlencoded(&#123; <span class="attr">extended</span>: <span class="literal">false</span> &#125;));</span><br><span class="line"></span><br><span class="line"><span class="comment">// 路由</span></span><br><span class="line"><span class="keyword">let</span> userRouter = <span class="built_in">require</span>(<span class="string">&quot;./router/userRouter&quot;</span>);</span><br><span class="line">app.use(<span class="string">&quot;/user&quot;</span>, userRouter); <span class="comment">// 127.0.0.1:3031/user/login  通过 user 再进入 userRouter 下寻找对应路由</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 开放静态资源 添加public 的化显示更加直观</span></span><br><span class="line">app.use(<span class="string">&quot;/public/&quot;</span>, express.static(<span class="string">&quot;./public/&quot;</span>));</span><br><span class="line"><span class="comment">// 省略 public 则对 url 显示更加简介简洁</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 使用 express-art-template 模板引擎 app.engine(&#x27;以什么后缀的文件&#x27;,)</span></span><br><span class="line">app.engine(<span class="string">&quot;html&quot;</span>, <span class="built_in">require</span>(<span class="string">&quot;express-art-template&quot;</span>));</span><br><span class="line"></span><br><span class="line"><span class="comment">// 监听端口号</span></span><br><span class="line">app.listen(<span class="number">3031</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">&quot;Express 服务器启动成功&quot;</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></div></details></li><li><p>路由</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> express = <span class="built_in">require</span>(<span class="string">&quot;express&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> router = express.Router();</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> comments = [];</span><br><span class="line"></span><br><span class="line">router.get(<span class="string">&quot;/index&quot;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  res.render(<span class="string">&quot;index.html&quot;</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">router.post(<span class="string">&quot;/pinglun&quot;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// 通过 req.body 获取post 表单请求数据</span></span><br><span class="line">  <span class="keyword">let</span> comment = req.body;</span><br><span class="line">  comments.unshift(comment);</span><br><span class="line">  res.render(<span class="string">&quot;pinglun.html&quot;</span>, &#123; <span class="attr">comments</span>: comments &#125;);</span><br><span class="line">&#125;);</span><br><span class="line"><span class="built_in">module</span>.exports = router;</span><br><span class="line"></span><br></pre></td></tr></table></figure></li><li><p>字符串转换为对象</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 文件中读取的数据一定是字符串</span></span><br><span class="line"><span class="comment">// 需要手动转换为 对象</span></span><br><span class="line"><span class="built_in">JSON</span>.parse(data).对象名</span><br></pre></td></tr></table></figure></li></ul><h4 id="设计路由"><a href="#设计路由" class="headerlink" title="设计路由"></a>设计路由</h4><table><thead><tr><th align="center">请求方法</th><th align="center">请求路径</th><th align="center">get参数</th><th align="center">post 参数</th><th align="center">备注</th></tr></thead><tbody><tr><td align="center"><code>GET</code></td><td align="center"><code>/students</code></td><td align="center"></td><td align="center"></td><td align="center">渲染首页</td></tr><tr><td align="center"><code>GET</code></td><td align="center"><code>/students/new</code></td><td align="center"></td><td align="center"></td><td align="center">渲染添加学生页</td></tr><tr><td align="center"><code>POST</code></td><td align="center"><code>/students/new</code></td><td align="center"></td><td align="center"><code>name，age，gender，hobbies</code></td><td align="center">处理添加学生请求</td></tr><tr><td align="center"><code>GET</code></td><td align="center"><code>/students/edit</code></td><td align="center"><code>id</code></td><td align="center"></td><td align="center">渲染编辑页面</td></tr><tr><td align="center"><code>POST</code></td><td align="center"><code>/students/edit</code></td><td align="center"></td><td align="center"><code>id，name，age，gender，hobbies</code></td><td align="center">处理编辑请求</td></tr><tr><td align="center"><code>GET</code></td><td align="center"><code>/students/delete</code></td><td align="center"><code>id</code></td><td align="center"></td><td align="center">处理删除请求</td></tr></tbody></table><div class="tabs" id="router"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#router-1">` 127.0.0.1:3031/students`首页</button></li><li class="tab"><button type="button" data-href="#router-2">`http://127.0.0.1:3031/students/new`用于学生信息添加</button></li><li class="tab"><button type="button" data-href="#router-3">异步函数save封装</button></li><li class="tab"><button type="button" data-href="#router-4">处理信息添加</button></li><li class="tab"><button type="button" data-href="#router-5">编辑路由</button></li><li class="tab"><button type="button" data-href="#router-6">删除</button></li><li class="tab"><button type="button" data-href="#router-7">资源文件获取</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="router-1"><ul><li><p>效果展示</p> <img src="https://cdn.jsdelivr.net/gh/lovobin/FileJsDeliver@v1.1.13/gif/3.gif" data-lazy-src="https://gitee.com/wang_hong_bin/repo-bin/raw/master/routerStudents.png" width="600"></li><li><p>路由规则</p><details><summary> 路由规则</summary><div class="content"><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 二级路由</span></span><br><span class="line"></span><br><span class="line">-------------------- 封装独立模块 stident --------------------</span><br><span class="line"></span><br><span class="line"><span class="built_in">exports</span>.find = <span class="function">(<span class="params">callback</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// 如果要获取一个函数中异步操作的结果 则必须通过回调函数来获取</span></span><br><span class="line">  fs.readFile(dbpath,<span class="string">&#x27;utf8&#x27;</span>, <span class="function">(<span class="params">err, data</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (err) &#123;</span><br><span class="line">      <span class="keyword">return</span> callback(err);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="built_in">console</span>.log(<span class="keyword">typeof</span> <span class="built_in">JSON</span>.parse(data).students);</span><br><span class="line">      <span class="comment">// callback 中的参数: 第一个是: 错误对象 第二个是: 数据</span></span><br><span class="line">      callback(<span class="literal">null</span>, <span class="built_in">JSON</span>.parse(data).students);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">-------------------------------------------</span><br><span class="line">    </span><br><span class="line">studentsRouter:</span><br><span class="line">		</span><br><span class="line">    <span class="comment">// 渲染首页</span></span><br><span class="line">    router.get(<span class="string">&quot;/&quot;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="comment">// 使用封装函数 find()</span></span><br><span class="line">      Student.find(<span class="function">(<span class="params">err, students</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (err) &#123;</span><br><span class="line">          <span class="keyword">return</span> res.status(<span class="number">500</span>).send(<span class="string">&quot;文件读取失败&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">          res.render(<span class="string">&quot;index.html&quot;</span>, &#123;</span><br><span class="line">            students: students,</span><br><span class="line">          &#125;);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;);</span><br><span class="line">    &#125;);</span><br></pre></td></tr></table></figure></div></details><p>模板字符串</p><details><summary> 模板字符串</summary><div class="content"><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">&lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">&quot;container&quot;</span>&gt;</span><br><span class="line">     &lt;!-- 超链接 a 进行页面跳转 href=[<span class="regexp">/students/</span><span class="keyword">new</span>]  实现第二个路由 --&gt;</span><br><span class="line">     &lt;p&gt;</span><br><span class="line">       &lt;a href=<span class="string">&quot;/students/new&quot;</span> <span class="class"><span class="keyword">class</span></span>=<span class="string">&quot;btn btn-info&quot;</span>&gt;添加学生&lt;/a&gt;</span><br><span class="line">     &lt;/p&gt;</span><br><span class="line">  </span><br><span class="line">     &lt;table <span class="class"><span class="keyword">class</span></span>=<span class="string">&quot;table table-bordered&quot;</span>&gt;</span><br><span class="line">       &lt;thead&gt;</span><br><span class="line">         &lt;th&gt;ID&lt;/th&gt;</span><br><span class="line">         &lt;th&gt;姓名&lt;/th&gt;</span><br><span class="line">         &lt;th&gt;年龄&lt;/th&gt;</span><br><span class="line">         &lt;th&gt;性别&lt;/th&gt;</span><br><span class="line">         &lt;th&gt;爱好&lt;/th&gt;</span><br><span class="line">       &lt;/thead&gt;</span><br><span class="line">       &lt;tbody&gt;</span><br><span class="line">         &#123;&#123;each students&#125;&#125;</span><br><span class="line">         &lt;tr&gt;</span><br><span class="line">           &lt;td&gt;&#123;&#123; $value.id &#125;&#125;&lt;/td&gt;</span><br><span class="line">           &lt;td&gt;&#123;&#123; $value.name &#125;&#125;&lt;/td&gt;</span><br><span class="line">           &lt;td&gt;&#123;&#123; $value.gender &#125;&#125;&lt;/td&gt;</span><br><span class="line">           &lt;td&gt;&#123;&#123; $value.age &#125;&#125;&lt;/td&gt;</span><br><span class="line">           &lt;td&gt;&#123;&#123; $value.hobbies &#125;&#125;&lt;/td&gt;</span><br><span class="line">         &lt;/tr&gt;</span><br><span class="line">         &#123;&#123;/each&#125;&#125;</span><br><span class="line">       &lt;/tbody&gt;</span><br><span class="line">     &lt;/table&gt;</span><br><span class="line">   &lt;/div&gt;</span><br></pre></td></tr></table></figure></div></details></li></ul><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="router-2"><ul><li><p>渲染效果</p> <img src="https://cdn.jsdelivr.net/gh/lovobin/FileJsDeliver@v1.1.13/gif/3.gif" data-lazy-src="https://gitee.com/wang_hong_bin/repo-bin/raw/master/addstudent.png"></li><li><p>路由规则</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 添加按钮点击跳转: get: 127.0.0.1:3031/students/new 渲染添加学生页</span></span><br><span class="line">router.get(<span class="string">&quot;/new&quot;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  res.render(<span class="string">&quot;new.html&quot;</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></li><li><p>模板字符串</p><details><summary> new-模板字符串</summary><div class="content"><div class="container"><h2 class="sub-header">添加学生信息</h2><form action="/students/new" method="post"><div class="form-group"> <label for="exampleInputEmail">姓名</label> <input type="text" class="form-control" id="exampleInputEmail" name="name"></div><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">    &lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">&quot;form-group&quot;</span>&gt;</span><br><span class="line">      &lt;label <span class="keyword">for</span>=<span class="string">&quot;&quot;</span>&gt; 性别 &lt;/label&gt;</span><br><span class="line">      &lt;div&gt;</span><br><span class="line">        &lt;label <span class="class"><span class="keyword">class</span></span>=<span class="string">&quot;radio-inline&quot;</span>&gt;</span><br><span class="line">          &lt;input type=<span class="string">&quot;radio&quot;</span> name=<span class="string">&quot;gender&quot;</span> id=<span class="string">&quot;inlineRadio1&quot;</span> value=<span class="string">&quot;0&quot;</span> /&gt;男</span><br><span class="line">        &lt;/label&gt;</span><br><span class="line">        &lt;label <span class="class"><span class="keyword">class</span></span>=<span class="string">&quot;radio-inline&quot;</span>&gt;</span><br><span class="line">          &lt;input type=<span class="string">&quot;radio&quot;</span> name=<span class="string">&quot;gender&quot;</span> id=<span class="string">&quot;inlineRadio2&quot;</span> value=<span class="string">&quot;1&quot;</span> /&gt;女</span><br><span class="line">        &lt;/label&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line"></span><br><span class="line">    &lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">&quot;form-group&quot;</span>&gt;</span><br><span class="line">      &lt;label <span class="keyword">for</span>=<span class="string">&quot;age&quot;</span>&gt;年龄&lt;/label&gt;</span><br><span class="line">      &lt;input <span class="class"><span class="keyword">class</span></span>=<span class="string">&quot;form-control&quot;</span> type=<span class="string">&quot;number&quot;</span> id=<span class="string">&quot;age&quot;</span> name=<span class="string">&quot;age&quot;</span> /&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">    &lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">&quot;checkout&quot;</span>&gt;</span><br><span class="line">      &lt;label&gt; 爱好 &lt;/label&gt;</span><br><span class="line">      &lt;input <span class="class"><span class="keyword">class</span></span>=<span class="string">&quot;form-control&quot;</span> type=<span class="string">&quot;text&quot;</span> name=<span class="string">&quot;hobbies&quot;</span> /&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">    &lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">&quot;btn&quot;</span>&gt;</span><br><span class="line">      &lt;button type=<span class="string">&quot;submit&quot;</span> <span class="class"><span class="keyword">class</span></span>=<span class="string">&quot;btn btn-info&quot;</span>&gt; 添加学员信息 &lt;/button&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  &lt;/form&gt;</span><br><span class="line">&lt;/div&gt;</span><br></pre></td></tr></table></figure></form></div></div></details></li></ul><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="router-3"><details><summary> 异步函数</summary><div class="content"><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="built_in">exports</span>.save = <span class="function">(<span class="params">student, callback</span>) =&gt;</span> &#123;</span><br><span class="line">  fs.readFile(dbpath, <span class="string">&quot;utf8&quot;</span>, <span class="function">(<span class="params">err, data</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (err) &#123;</span><br><span class="line">      <span class="keyword">return</span> callback(err);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="keyword">let</span> students = <span class="built_in">JSON</span>.parse(data).students;</span><br><span class="line">      <span class="comment">// 处理 id: 获取数组的最后一个 再加 1</span></span><br><span class="line">      student.id = students[students.length - <span class="number">1</span>].id + <span class="number">1</span>;</span><br><span class="line">      <span class="comment">// 添加数据</span></span><br><span class="line">      students.push(student);</span><br><span class="line">      <span class="comment">// 把对象数据转换为字符串</span></span><br><span class="line">      <span class="keyword">let</span> result = <span class="built_in">JSON</span>.stringify(&#123; <span class="attr">students</span>: students &#125;);</span><br><span class="line">      <span class="comment">// 把字符串保存到文件中</span></span><br><span class="line">      fs.writeFile(dbpath, result, <span class="function">(<span class="params">err</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (err) &#123;</span><br><span class="line">          <span class="comment">// 错误 就返回错误对象</span></span><br><span class="line">          <span class="keyword">return</span> callback(err);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">          <span class="comment">// 成功就不报错 返回空对象</span></span><br><span class="line">          callback(<span class="literal">null</span>);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></div></details><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="router-4"><ul><li><p>效果预览</p> <img src="https://cdn.jsdelivr.net/gh/lovobin/FileJsDeliver@v1.1.13/gif/3.gif" data-lazy-src="https://img-blog.csdnimg.cn/20210303154910327.gif"></li><li><p>路由规则</p><details><summary> `post:127.0.0.1:3031/students/new`</summary><div class="content"><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 处理添加学生请求 post: 127.0.0.1:3031/students/new</span></span><br><span class="line">router.post(<span class="string">&quot;/new&quot;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// 1. 获取表单数据 post: body-parser</span></span><br><span class="line">  <span class="keyword">let</span> formdata = req.body;</span><br><span class="line">  <span class="comment">// 2, 处理  将数据保存到 db.json 文件中</span></span><br><span class="line">  <span class="comment">// 预处理: 由于文件都是字符串非对象 所以只能先行读取 在追加 追加结束后再对文件进行写入操作</span></span><br><span class="line">  <span class="comment">// 具体操作: 1. 先读取出来 转成对象 2. 然后往对象中 push 数据 3. 然后把对象转换为 字符串 然后把字符串再次写入文件</span></span><br><span class="line">  <span class="comment">// 3. 发送响应 res.body</span></span><br><span class="line">  Student.save(formdata, <span class="function">(<span class="params">err</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (err) &#123;</span><br><span class="line">      <span class="keyword">return</span> res.status(<span class="number">500</span>).send(<span class="string">&quot;&#123;&#x27;error&#x27;: &#x27;not found&#x27;&#125;&quot;</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      res.redirect(<span class="string">&quot;/students&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></div></details></li></ul><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="router-5"><ul><li><p>路由规则逻辑</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">// 处理删除请求</span></span><br><span class="line">router.get(<span class="string">&quot;/delete&quot;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// 1. 获取要删除的 id</span></span><br><span class="line">  <span class="comment">// 2. 根据 id 执行删除操作</span></span><br><span class="line">  <span class="comment">// 3. 根据操作结果发送响应数据</span></span><br><span class="line">  Student.deleteById(req.query.id, <span class="function">(<span class="params">err</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (err) &#123;</span><br><span class="line">      <span class="keyword">return</span> res.status(<span class="number">500</span>).send(<span class="string">&quot;Server error&quot;</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      res.redirect(<span class="string">&#x27;/students&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></li><li><p>异步函数</p><details><summary> edit-异步函数</summary><div class="content"><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="built_in">exports</span>.updateById = <span class="function">(<span class="params">student, callback</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// 如果要获取一个函数中异步操作的结果 则必须通过回调函数来获取</span></span><br><span class="line">  fs.readFile(dbpath, <span class="string">&quot;utf8&quot;</span>, <span class="function">(<span class="params">err, data</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (err) &#123;</span><br><span class="line">      <span class="keyword">return</span> callback(err);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="comment">// find: 需要接受一个函数作为参数 作用: 当某个遍历项符合 item.id===student.id 条件的时候 find 会终止遍历 同时返回遍历结果</span></span><br><span class="line">      <span class="keyword">let</span> students = <span class="built_in">JSON</span>.parse(data).students;</span><br><span class="line"></span><br><span class="line">      student.id = <span class="built_in">parseInt</span>(student.id);</span><br><span class="line">      <span class="keyword">var</span> stu = students.find(<span class="function">(<span class="params">item</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="comment">// 用户传入 id</span></span><br><span class="line">        <span class="keyword">return</span> item.id === student.id</span><br><span class="line">      &#125;);</span><br><span class="line"></span><br><span class="line">      <span class="comment">// 修改数据</span></span><br><span class="line">      <span class="keyword">for</span> (<span class="keyword">let</span> key <span class="keyword">in</span> student) &#123;</span><br><span class="line">        stu[key] = student[key];</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">// 把对象转换为字符串</span></span><br><span class="line">      <span class="keyword">let</span> fileDate = <span class="built_in">JSON</span>.stringify(&#123;</span><br><span class="line">        students: students</span><br><span class="line">      &#125;);</span><br><span class="line">      <span class="comment">// 把字符串保存到文件中</span></span><br><span class="line">      fs.writeFile(dbpath, fileDate, <span class="function">(<span class="params">err</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (err) &#123;</span><br><span class="line">          <span class="comment">// 错误就是把错误对象传递给它</span></span><br><span class="line">          <span class="keyword">return</span> callback(err);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">          <span class="comment">// 成功就没错 所以错误对象就是 null</span></span><br><span class="line">          <span class="keyword">return</span> callback(<span class="literal">null</span>);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">&#125;;</span><br><span class="line"></span><br></pre></td></tr></table></figure></div></details></li></ul><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="router-6"><ul><li><p>删除异步函数</p><details><summary> delete-异步函数</summary><div class="content"><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">exports</span>.deleteById = <span class="function">(<span class="params">id, callback</span>) =&gt;</span> &#123;</span><br><span class="line">  fs.readFile(dbpath, <span class="string">&#x27;utf8&#x27;</span>, <span class="function">(<span class="params">err, data</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (err) &#123;</span><br><span class="line">      <span class="keyword">return</span> callback(err);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="keyword">let</span> students = <span class="built_in">JSON</span>.parse(data).students;</span><br><span class="line"></span><br><span class="line">      <span class="comment">// findIndex 方法专门用来根据条件查找元素的下标</span></span><br><span class="line">      <span class="keyword">let</span> deleteId = students.findIndex(<span class="function">(<span class="params">item</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> item.id === <span class="built_in">parseInt</span>(id);</span><br><span class="line">      &#125;);</span><br><span class="line">      <span class="comment">// 根据下标从数组中删除对应的学生对象</span></span><br><span class="line">      students.splice(deleteId, <span class="number">1</span>);</span><br><span class="line">      <span class="comment">// 删除数据后进行重写</span></span><br><span class="line">      <span class="keyword">let</span> fileData = <span class="built_in">JSON</span>.stringify(&#123;</span><br><span class="line">        students: students</span><br><span class="line">      &#125;);</span><br><span class="line">      <span class="comment">// 把字符串保存到文件中</span></span><br><span class="line">      fs.writeFile(dbpath, fileData, <span class="function">(<span class="params">err</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (err) &#123;</span><br><span class="line">          <span class="comment">// 错误就是把错误对象传递给它</span></span><br><span class="line">          <span class="keyword">return</span> callback(err);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">          <span class="comment">// 成功就是没错 所以把错误对象就是 null</span></span><br><span class="line">          callback(<span class="literal">null</span>);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></div></details></li></ul><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="router-7"><p><a href=""></a></p> <img src="https://cdn.jsdelivr.net/gh/lovobin/FileJsDeliver@v1.1.13/gif/3.gif" data-lazy-src="https://img-blog.csdnimg.cn/20210315002450372.gif" title="Node-增删改查"><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者:</span> <span class="post-copyright-info"><a href="mailto:undefined">源于此</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接:</span> <span class="post-copyright-info"><a href="https://lovobin.github.io/2021/02/04/Node%E5%9F%BA%E7%A1%80/">https://lovobin.github.io/2021/02/04/Node%E5%9F%BA%E7%A1%80/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明:</span> <span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://lovobin.github.io" target="_blank">源于此</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/Javascript/">Javascript</a><a class="post-meta__tags" href="/tags/Node/">Node</a></div><div class="post_share"><div class="social-share" data-image="https://cdn.jsdelivr.net/gh/lovobin/hiddenContent@v1.0.5/bg/13.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css" media="print" onload='this.media="all"'><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js" defer="defer"></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2021/02/06/gitcalendar-%E6%8C%82%E6%8E%89%E6%96%B0%E4%BF%AE%E5%A4%8D/"><img class="prev-cover" data-lazy-src="https://cdn.jsdelivr.net/gh/lovobin/hiddenContent@v1.0.6/bbg/32.jpg" onerror='onerror=null,src="/img/404.jpg"' alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">gitcalendar 挂掉新修复</div></div></a></div><div class="next-post pull-right"><a href="/2021/02/02/Javascript-%E5%AF%B9%E8%B1%A1/"><img class="next-cover" data-lazy-src="https://cdn.jsdelivr.net/gh/lovobin/hiddenContent@v1.0.5/bg/10.jpg" onerror='onerror=null,src="/img/404.jpg"' alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">Javascript-对象</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i> <span>相关推荐</span></div><div class="relatedPosts-list"><div><a href="/2021/01/29/JavaScript-闭包/" title="JavaScript-闭包"><img class="cover" data-lazy-src="https://cdn.jsdelivr.net/gh/lovobin/hiddenContent@v1.0.5/bg/12.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-01-29</div><div class="title">JavaScript-闭包</div></div></a></div><div><a href="/2021/01/29/Javascript-练习/" title="Javascript-练习"><img class="cover" data-lazy-src="https://cdn.jsdelivr.net/gh/lovobin/hiddenContent@v1.0.4/re-6.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-01-29</div><div class="title">Javascript-练习</div></div></a></div><div><a href="/2021/01/18/Javascript-面向对象编程/" title="Javascript-面向对象编程"><img class="cover" data-lazy-src="https://cdn.jsdelivr.net/gh/lovobin/hiddenContent@v1.0.4/re-4.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-01-18</div><div class="title">Javascript-面向对象编程</div></div></a></div><div><a href="/2021/02/10/MongoDB-安装/" title="MongoDB-安装"><img class="cover" data-lazy-src="https://cdn.jsdelivr.net/gh/lovobin/hiddenContent@v1.0.4/re-15.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-02-10</div><div class="title">MongoDB-安装</div></div></a></div><div><a href="/2021/02/18/Node-多人博客项目/" title="Node-多人博客项目"><img class="cover" data-lazy-src="https://cdn.jsdelivr.net/gh/lovobin/hiddenContent@v1.0.6/bbg/12.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-02-18</div><div class="title">Node-多人博客项目</div></div></a></div><div><a href="/2021/02/25/编写接口文档/" title="编写接口文档"><img class="cover" data-lazy-src="https://cdn.jsdelivr.net/gh/lovobin/hiddenContent@v1.0.6/bbg/34.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-02-25</div><div class="title">编写接口文档</div></div></a></div></div></div><hr><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i> <span>评论</span></div></div><div class="comment-wrap"><div><div class="vcomment" id="vcomment"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="card-info-avatar is-center"><img class="avatar-img" data-lazy-src="https://gitee.com/wang_hong_bin/pic-go-photos/raw/master/avatar.png" onerror='this.onerror=null,this.src="/img/friend_404.gif"' alt="avatar"><div class="author-info__name">源于此</div><div class="author-info__description">专注于分享</div></div><div class="card-info-data"><div class="card-info-data-item is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">121</div></a></div><div class="card-info-data-item is-center"><a href="/tags/"><div class="headline">标签</div><div class="length-num">64</div></a></div><div class="card-info-data-item is-center"><a href="/categories/"><div class="headline">分类</div><div class="length-num">27</div></a></div></div><a class="button--animated" id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/lovobin"><i class="fab fa-github"></i><span>源于此</span></a></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn card-announcement-animation"></i><span>公告</span></div><div class="announcement_content"><p><a target="_blank" rel="noopener" href="http://wang_hong_bin.gitee.io/hexoblog/"><img src="https://img.shields.io/badge/Theme-Matery-red"></a></p><p><a target="_blank" rel="noopener" href="http://aidou.3vfree.com/"><img src="https://img.shields.io/badge/Gitee-Gitee--Matery-red"></a></p><a target="_blank" rel="noopener" href="https://learnmore.vercel.app/"><img src="https://img.shields.io/badge/Gitee-Vercel-red"></a><p></p><p>请勿尝试破解本站未知密码,渗透测试!</p></div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#Node%E5%9F%BA%E7%A1%80"><span class="toc-number">1.</span> <span class="toc-text">Node基础</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%91%BD%E4%BB%A4%E8%A1%8C%E5%9F%BA%E7%A1%80"><span class="toc-number">1.1.</span> <span class="toc-text">命令行基础</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%BF%9B%E7%A8%8B%E5%92%8C%E7%BA%BF%E7%A8%8B"><span class="toc-number">1.2.</span> <span class="toc-text">进程和线程</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Node-%E7%AE%80%E4%BB%8B"><span class="toc-number">1.3.</span> <span class="toc-text">Node 简介</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Node-%E5%AE%89%E8%A3%85%E4%BD%BF%E7%94%A8"><span class="toc-number">1.4.</span> <span class="toc-text">Node 安装使用</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8C%85%EF%BC%88package%EF%BC%89"><span class="toc-number">1.5.</span> <span class="toc-text">包（package）</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Node"><span class="toc-number">2.</span> <span class="toc-text">Node</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%B3%BB%E7%BB%9F%E6%A8%A1%E5%9D%97"><span class="toc-number">2.1.</span> <span class="toc-text">系统模块</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E8%AF%BB%E5%86%99%E6%96%87%E4%BB%B6"><span class="toc-number">2.1.1.</span> <span class="toc-text">读写文件</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%AC%AC%E4%B8%89%E6%96%B9%E6%A8%A1%E5%9D%97"><span class="toc-number">2.2.</span> <span class="toc-text">第三方模块</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#package-json"><span class="toc-number">2.3.</span> <span class="toc-text">package.json</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%AB%AF%E5%9F%BA%E7%A1%80%E6%A6%82%E5%BF%B5"><span class="toc-number">2.4.</span> <span class="toc-text">服务器端基础概念</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%AE%80%E5%8D%95%E7%9A%84-http-%E6%9C%8D%E5%8A%A1"><span class="toc-number">2.5.</span> <span class="toc-text">简单的 http 服务</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#HTTP-%E5%8D%8F%E8%AE%AE"><span class="toc-number">2.6.</span> <span class="toc-text">HTTP 协议</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#HTTP-%E8%AF%B7%E6%B1%82%E4%B8%8E%E5%93%8D%E5%BA%94%E5%A4%84%E7%90%86"><span class="toc-number">2.7.</span> <span class="toc-text">HTTP 请求与响应处理</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%B7%AF%E7%94%B1"><span class="toc-number">2.8.</span> <span class="toc-text">路由</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%90%8C%E6%AD%A5API%E5%92%8C%E5%BC%82%E6%AD%A5API"><span class="toc-number">2.9.</span> <span class="toc-text">同步API和异步API</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Promise"><span class="toc-number">2.10.</span> <span class="toc-text">Promise</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%BC%82%E6%AD%A5%E5%87%BD%E6%95%B0"><span class="toc-number">2.11.</span> <span class="toc-text">异步函数</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E5%BA%93"><span class="toc-number">2.12.</span> <span class="toc-text">数据库</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%A8%A1%E6%9D%BF%E5%BC%95%E6%93%8E"><span class="toc-number">2.13.</span> <span class="toc-text">模板引擎</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Express-%E6%A1%86%E6%9E%B6"><span class="toc-number">2.14.</span> <span class="toc-text">Express 框架</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#express"><span class="toc-number">2.14.1.</span> <span class="toc-text">express</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#Express%E4%B8%8B%E8%BD%BD"><span class="toc-number">2.14.2.</span> <span class="toc-text">Express下载</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%B8%AD%E9%97%B4%E4%BB%B6"><span class="toc-number">2.14.3.</span> <span class="toc-text">中间件</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%B8%AD%E9%97%B4%E4%BB%B6%E7%9A%84%E5%BA%94%E7%94%A8"><span class="toc-number">2.14.4.</span> <span class="toc-text">中间件的应用</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E9%94%99%E8%AF%AF%E5%A4%84%E7%90%86%E4%B8%AD%E9%97%B4%E4%BB%B6"><span class="toc-number">2.14.5.</span> <span class="toc-text">错误处理中间件</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%8D%95%E8%8E%B7%E9%94%99%E8%AF%AF"><span class="toc-number">2.14.6.</span> <span class="toc-text">捕获错误</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#Express-%E8%AF%B7%E6%B1%82%E5%A4%84%E7%90%86"><span class="toc-number">2.14.7.</span> <span class="toc-text">Express 请求处理</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#GET%E8%AF%B7%E6%B1%82%E5%8F%82%E6%95%B0%E5%A4%84%E7%90%86"><span class="toc-number">2.14.8.</span> <span class="toc-text">GET请求参数处理</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#POST-%E8%AF%B7%E6%B1%82%E5%8F%82%E6%95%B0%E5%A4%84%E7%90%86"><span class="toc-number">2.14.9.</span> <span class="toc-text">POST 请求参数处理</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#Express-%E8%B7%AF%E7%94%B1%E5%8F%82%E6%95%B0"><span class="toc-number">2.14.10.</span> <span class="toc-text">Express 路由参数</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#Express-%E9%9D%99%E6%80%81%E8%B5%84%E6%BA%90%E5%A4%84%E7%90%86"><span class="toc-number">2.14.11.</span> <span class="toc-text">Express 静态资源处理</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%A8%A1%E6%9D%BF%E5%BC%95%E6%93%8E-1"><span class="toc-number">2.14.12.</span> <span class="toc-text">模板引擎</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Node-%E6%B7%B1%E5%85%A5%E8%A1%A5%E5%85%85"><span class="toc-number">3.</span> <span class="toc-text">Node 深入补充</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%B3%BB%E7%BB%9F%E6%A8%A1%E5%9D%97-1"><span class="toc-number">3.1.</span> <span class="toc-text">系统模块</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E8%AF%BB%E5%8F%96%E7%9B%AE%E5%BD%95%E6%A0%91"><span class="toc-number">3.1.1.</span> <span class="toc-text">读取目录树</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%88%9B%E5%BB%BA%E7%9B%AE%E5%BD%95"><span class="toc-number">3.1.2.</span> <span class="toc-text">创建目录</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%9B%B4%E6%94%B9"><span class="toc-number">3.1.3.</span> <span class="toc-text">更改</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%88%A0%E9%99%A4"><span class="toc-number">3.1.4.</span> <span class="toc-text">删除</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%96%87%E4%BB%B6%E8%AF%BB%E5%86%99%E5%88%A0%E9%99%A4"><span class="toc-number">3.1.5.</span> <span class="toc-text">文件读写删除</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#URL"><span class="toc-number">3.1.6.</span> <span class="toc-text">URL</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Express-%E8%B7%AF%E7%94%B1"><span class="toc-number">3.2.</span> <span class="toc-text">Express 路由</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%A8%A1%E6%9D%BF%E5%BC%95%E6%93%8E-2"><span class="toc-number">3.3.</span> <span class="toc-text">模板引擎</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%A8%A1%E6%9D%BF%E5%BC%95%E6%93%8E%E4%B8%8B%E8%BD%BD"><span class="toc-number">3.3.1.</span> <span class="toc-text">模板引擎下载</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E6%A8%A1%E6%9D%BF%E5%BC%95%E6%93%8E"><span class="toc-number">3.3.2.</span> <span class="toc-text">使用模板引擎</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8C%85%E8%AF%B4%E6%98%8E%E6%96%87%E4%BB%B6"><span class="toc-number">3.4.</span> <span class="toc-text">包说明文件</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#NPM"><span class="toc-number">3.5.</span> <span class="toc-text">NPM</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Express"><span class="toc-number">3.6.</span> <span class="toc-text">Express</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%B8%8B%E8%BD%BD"><span class="toc-number">3.6.1.</span> <span class="toc-text">下载</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8"><span class="toc-number">3.6.2.</span> <span class="toc-text">使用</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E9%9D%99%E6%80%81%E8%B5%84%E6%BA%90%E6%96%87%E4%BB%B6%E8%B7%AF%E5%BE%84%E5%BC%80%E6%94%BE%E9%97%AE%E9%A2%98"><span class="toc-number">3.6.3.</span> <span class="toc-text">静态资源文件路径开放问题</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#GET%E8%AF%B7%E6%B1%82%E5%8F%82%E6%95%B0%E5%A4%84%E7%90%86%E6%A1%88%E4%BE%8B"><span class="toc-number">3.7.</span> <span class="toc-text">GET请求参数处理案例</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%A8%A1%E6%9D%BF%E5%BC%95%E6%93%8E-3"><span class="toc-number">3.8.</span> <span class="toc-text">模板引擎</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%B8%8B%E8%BD%BD%E6%A8%A1%E6%9D%BF%E5%BC%95%E6%93%8E"><span class="toc-number">3.8.1.</span> <span class="toc-text">下载模板引擎</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E9%85%8D%E7%BD%AEart-template"><span class="toc-number">3.8.2.</span> <span class="toc-text">配置art-template</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8art-template"><span class="toc-number">3.8.3.</span> <span class="toc-text">使用art-template</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E9%85%8D%E7%BD%AEviews%E7%9B%AE%E5%BD%95"><span class="toc-number">3.8.4.</span> <span class="toc-text">配置views目录</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#POST-%E8%A1%A8%E5%8D%95%E6%95%B0%E6%8D%AE%E5%A4%84%E7%90%86"><span class="toc-number">3.9.</span> <span class="toc-text">POST 表单数据处理</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%AE%BE%E8%AE%A1%E8%B7%AF%E7%94%B1"><span class="toc-number">3.10.</span> <span class="toc-text">设计路由</span></a></li></ol></li></ol><li class="toc-item toc-level-2"><a class="toc-link" href="#router-2"><span class="toc-number"></span> <span class="toc-text">添加学生信息</span></a></li></div></div><div class="card-widget card-clock"><div id="clock"><img v-if="clockshow == &quot;false&quot;" alt="" src="/assets/weather/loading.gif" height="120px" width="100%"><table class="clock" v-if="clockshow"><tbody><tr><td class="clockdate">{{date}}</td><td class="weatherimg"><img id="weatherimg" :src="weatherimg" alt=""></td><td class="temperature">{{temperature}}</td><td class="humidityimg"><img id="humidityimg" :src="humidityimg" alt=""></td><td class="humidity">{{humidity}}</td></tr><tr class="time"><td colspan="5">{{time}}</td></tr><tr><td class="usaqi" colspan="1"><span>{{ip}}</span></td><td class="city" colspan="2">{{city}}</td><td class="daylight" colspan="2">{{daylight}}</td></tr></tbody></table></div></div><script defer="defer" data-pjax="data-pjax" src="https://cdn.jsdelivr.net/gh/lovobin/Access@b1.0/card_clock.js"></script><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2021/03/16/%E8%8B%B1%E8%AF%AD%E5%AD%A6%E4%B9%A0/" title="英语学习"><img data-lazy-src="https://cdn.jsdelivr.net/gh/lovobin/hiddenContent@v1.0.4/re-15.jpg" onerror='this.onerror=null,this.src="/img/404.jpg"' alt="英语学习"></a><div class="content"><a class="title" href="/2021/03/16/%E8%8B%B1%E8%AF%AD%E5%AD%A6%E4%B9%A0/" title="英语学习">英语学习</a><time datetime="2021-03-16T19:15:39.000Z" title="发表于 2021-03-16 19:15:39">2021-03-16</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2021/03/16/Hexo-%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E9%85%8D%E7%BD%AE/" title="Hexo-后台管理配置"><img data-lazy-src="https://cdn.jsdelivr.net/gh/lovobin/hiddenContent@v1.0.6/bbg/26.jpg" onerror='this.onerror=null,this.src="/img/404.jpg"' alt="Hexo-后台管理配置"></a><div class="content"><a class="title" href="/2021/03/16/Hexo-%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E9%85%8D%E7%BD%AE/" title="Hexo-后台管理配置">Hexo-后台管理配置</a><time datetime="2021-03-16T14:29:14.000Z" title="发表于 2021-03-16 14:29:14">2021-03-16</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2021/03/11/Github-Actions-%E8%87%AA%E5%8A%A8%E5%8C%96%E9%83%A8%E7%BD%B2%E6%80%BB%E7%BB%93/" title="Github-Actions-自动化部署总结"><img data-lazy-src="https://cdn.jsdelivr.net/gh/lovobin/Access@v1.0/medias/featureimages/20.jpg" onerror='this.onerror=null,this.src="/img/404.jpg"' alt="Github-Actions-自动化部署总结"></a><div class="content"><a class="title" href="/2021/03/11/Github-Actions-%E8%87%AA%E5%8A%A8%E5%8C%96%E9%83%A8%E7%BD%B2%E6%80%BB%E7%BB%93/" title="Github-Actions-自动化部署总结">Github-Actions-自动化部署总结</a><time datetime="2021-03-11T22:20:00.000Z" title="发表于 2021-03-11 22:20:00">2021-03-11</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2021/02/25/%E7%BC%96%E5%86%99%E6%8E%A5%E5%8F%A3%E6%96%87%E6%A1%A3/" title="编写接口文档"><img data-lazy-src="https://cdn.jsdelivr.net/gh/lovobin/hiddenContent@v1.0.6/bbg/34.png" onerror='this.onerror=null,this.src="/img/404.jpg"' alt="编写接口文档"></a><div class="content"><a class="title" href="/2021/02/25/%E7%BC%96%E5%86%99%E6%8E%A5%E5%8F%A3%E6%96%87%E6%A1%A3/" title="编写接口文档">编写接口文档</a><time datetime="2021-02-25T17:28:05.000Z" title="发表于 2021-02-25 17:28:05">2021-02-25</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2021/02/18/Bootstrap-%E6%A1%86%E6%9E%B6/" title="Bootstrap-框架"><img data-lazy-src="https://cdn.jsdelivr.net/gh/lovobin/hiddenContent@v1.0.6/bbg/28.jpg" onerror='this.onerror=null,this.src="/img/404.jpg"' alt="Bootstrap-框架"></a><div class="content"><a class="title" href="/2021/02/18/Bootstrap-%E6%A1%86%E6%9E%B6/" title="Bootstrap-框架">Bootstrap-框架</a><time datetime="2021-02-18T11:35:16.000Z" title="发表于 2021-02-18 11:35:16">2021-02-18</time></div></div></div></div></div></div></main><footer id="footer" style="background-image:url(https://cdn.jsdelivr.net/gh/lovobin/hiddenContent@v1.0.5/bg/13.jpg)"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2021 By 源于此</div><div class="framework-info"><span>框架</span> <a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题</span> <a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div><div class="footer_custom_text"><p><img src="https://img.shields.io/badge/Frame-Hexo-orange">&nbsp;<img src="https://img.shields.io/badge/Theme-Buffterfly-blue">&nbsp;<img src="https://img.shields.io/badge/CDN-jsDeliver-blueviolet">&nbsp;<img src="https://img.shields.io/badge/Source-Github-9cf">&nbsp;<img src="https://img.shields.io/badge/Theme-Matery-ff69b4">&nbsp;<img src="https://img.shields.io/badge/Python-Python-success">&nbsp;<img src="https://img.shields.io/badge/Python-Flask-red"></p><p><img src="https://img.shields.io/badge/Theme-Butterfly-red?logo=Castorama&logoWidth=18">&nbsp;<img src="https://img.shields.io/badge/Frame-Hexo-blue?logo=Grunt&logoWidth=18"></p></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div id="local-search"><div class="search-dialog"><div class="search-dialog__title" id="local-search-title">本地搜索</div><div id="local-input-panel"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"></div></div></div><hr><div id="local-search-results"></div><span class="search-close-button"><i class="fas fa-times"></i></span></div><div id="search-mask"></div></div><div><script src="https://cdn.jsdelivr.net/npm/vue@2.6.11"></script><script src="https://cdn.jsdelivr.net/gh/lovobin/Access@b1.0/utils.js"></script><script src="https://cdn.jsdelivr.net/gh/lovobin/Access@b1.0/main.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page/instantpage.min.js" type="module"></script><script src="https://cdn.jsdelivr.net/npm/vanilla-lazyload/dist/lazyload.iife.min.js"></script><script src="https://cdn.jsdelivr.net/gh/lovobin/Access@b1.0/local-search.js"></script><div class="js-pjax"><script>function loadValine () {
  function initValine () {
    let initData = {
      el: '#vcomment',
      appId: 'mBJmPXWzwyV04mxhgYDlcesh-MdYXbMMI',
      appKey: 'YmiNUWFhvvnoxmwyOo4iAEUy',
      placeholder: 'Please leave your footprints',
      avatar: 'monsterid',
      meta: 'nick,mail,link'.split(','),
      pageSize: '10',
      lang: 'zh-CN',
      recordIP: false,
      serverURLs: '',
      emojiCDN: '',
      emojiMaps: "",
      enableQQ: false,
      path: window.location.pathname,
    }

    if (true) { 
      initData.requiredFields= ('nick,mail'.split(','))
    }
    
    if (false) {
      const otherData = false
      initData = Object.assign(initData, otherData)
    }
    
    const valine = new Valine(initData)
  }

  if (typeof Valine === 'function') initValine() 
  else getScript('https://cdn.jsdelivr.net/npm/valine/dist/Valine.min.js').then(initValine)
}

if ('Valine' === 'Valine' || !false) {
  if (false) btf.loadComment(document.getElementById('vcomment'),loadValine)
  else setTimeout(loadValine, 0)
} else {
  function loadOtherComment () {
    loadValine()
  }
}</script></div><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script defer="defer" src="https://cdn.jsdelivr.net/npm/hexo-theme-volantis@latest/source/js/issues.min.js"></script><script src="https://cdn.jsdelivr.net/npm/vue@2.6.11"></script><script data-pjax src="https://cdn.jsdelivr.net/gh/lovobin/FileJsDeliver@v1.1.13/swiper/swiper.min.js"></script><script data-pjax src="https://cdn.jsdelivr.net/gh/lovobin/FileJsDeliver@v1.1.13/swiper/swiperindex.js"></script><script src="https://cdn.jsdelivr.net/gh/graingert/wow@1.3.0/dist/wow.min.js"></script><script data-pjax src="https://cdn.jsdelivr.net/gh/lovobin/Live2d@v1.0/live2d-widget/autoload.js"></script><canvas class="fireworks" mobile="false"></canvas><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/fireworks.min.js"></script><script defer="defer" id="fluttering_ribbon" mobile="false" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/canvas-fluttering-ribbon.min.js"></script><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/activate-power-mode.min.js"></script><script>POWERMODE.colorful=!0,POWERMODE.shake=!0,POWERMODE.mobile=!1,document.body.addEventListener("input",POWERMODE)</script><script src="https://cdn.jsdelivr.net/npm/pjax/pjax.min.js"></script><script>let pjaxSelectors = [
  'title',
  '#config-diff',
  '#body-wrap',
  '#rightside-config-hide',
  '#rightside-config-show',
  '.js-pjax'
]

if (false) {
  pjaxSelectors.unshift('meta[property="og:image"]', 'meta[property="og:title"]', 'meta[property="og:url"]')
}

var pjax = new Pjax({
  elements: 'a:not([target="_blank"])',
  selectors: pjaxSelectors,
  cacheBust: false,
  analytics: false,
  scrollRestoration: false
})

document.addEventListener('pjax:complete', function () {
  window.refreshFn()

  document.querySelectorAll('script[data-pjax]').forEach(item => {
    const newScript = document.createElement('script')
    const content = item.text || item.textContent || item.innerHTML || ""
    Array.from(item.attributes).forEach(attr => newScript.setAttribute(attr.name, attr.value))
    newScript.appendChild(document.createTextNode(content))
    item.parentNode.replaceChild(newScript, item)
  })

  GLOBAL_CONFIG.islazyload && window.lazyLoadInstance.update()

  typeof chatBtnFn === 'function' && chatBtnFn()
  typeof panguInit === 'function' && panguInit()

  if (typeof gtag === 'function') {
    gtag('config', '', {'page_path': window.location.pathname});
  }

  typeof loadMeting === 'function' && document.getElementsByClassName('aplayer').length && loadMeting()

  // Analytics
  if (false) {
    MtaH5.pgv()
  }

  // prismjs
  typeof Prism === 'object' && Prism.highlightAll()

  typeof preloader === 'object' && preloader.endLoading()
})


document.addEventListener('pjax:send', function () {
  typeof preloader === 'object' && preloader.initLoading()
  
  if (window.aplayers) {
    for (let i = 0; i < window.aplayers.length; i++) {
      if (!window.aplayers[i].options.fixed) {
        window.aplayers[i].destroy()
      }
    }
  }

  typeof typed === 'object' && typed.destroy()

  //reset readmode
  const $bodyClassList = document.body.classList
  $bodyClassList.contains('read-mode') && $bodyClassList.remove('read-mode')

})

document.addEventListener('pjax:error', (e) => {
  if (e.request.status === 404) {
    pjax.loadUrl('/404.html')
  }
})</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div><script data-pjax src="https://cdn.jsdelivr.net/gh/Zfour/hexo-github-calendar@1.21/hexo_githubcalendar.js"></script><script data-pjax>function GithubCalendarConfig(){var t=document.getElementById("recent-posts");t&&"/"==location.pathname&&(console.log("已挂载github calendar"),t.insertAdjacentHTML("afterbegin",'<div class="recent-post-item" style="width:100%;height:auto;padding:10px;"><div id="github_loading" style="width:10%;height:100%;margin:0 auto;display: block"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"  viewBox="0 0 50 50" style="enable-background:new 0 0 50 50" xml:space="preserve"><path fill="#d0d0d0" d="M25.251,6.461c-10.318,0-18.683,8.365-18.683,18.683h4.068c0-8.071,6.543-14.615,14.615-14.615V6.461z" transform="rotate(275.098 25 25)"><animateTransform attributeType="xml" attributeName="transform" type="rotate" from="0 25 25" to="360 25 25" dur="0.6s" repeatCount="indefinite"></animateTransform></path></svg></div><div id="github_container"></div></div>')),GithubCalendar("https://python-github-calendar-api.vercel.app/api?lovobin",["#ebedf0","#fdcdec","#fc9bd9","#fa6ac5","#f838b2","#f5089f","#c4067e","#92055e","#540336","#48022f","#30021f"],"lovobin")}document.getElementById("recent-posts")&&GithubCalendarConfig()</script><style>#github_container{min-height:280px}@media screen and (max-width:650px){#github_container{min-height:0}}</style><style></style></body></html>